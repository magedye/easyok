# ============================================================================
# EasyData - Environment Configuration (REFERENCE TEMPLATE)
# ============================================================================
# This file is the SINGLE SOURCE OF TRUTH for environment structure.
# Copy this file to `.env` and only change variables marked with:
# >>> CHANGE ME <<<
#
# You can fully enable/disable security by toggles below
# WITHOUT changing any code.
# ============================================================================


# ============================================================================
# Application
# ============================================================================
APP_NAME=EasyData
APP_VERSION=16.0.0

# Runtime environment
# Allowed values: development | staging | production
APP_ENV=development

# Debug mode (MUST be false in production)
DEBUG=false


# ============================================================================
# Core Provider Selectors (Single Source of Truth)
# DO NOT branch logic elsewhere
# ============================================================================
DB_PROVIDER=oracle
# Allowed values:
# - oracle
# - mssql

LLM_PROVIDER=openai
# Allowed values:
# - openai
# - google
# - ollama
# - openai_compatible
# - groq

VECTOR_DB=chromadb
# Allowed values:
# - chromadb
# - qdrant


ENABLE_SEMANTIC_CACHE=true


# ============================================================================
# Security Toggles
# Set AUTH_ENABLED=false to run EasyData with NO authentication at all
# ============================================================================
AUTH_ENABLED=true
RBAC_ENABLED=true
RLS_ENABLED=true

# Behavior rules:
# - If AUTH_ENABLED=false:
#     * All requests are allowed
#     * JWT is completely ignored
#     * RBAC and RLS are implicitly disabled
#
# - RBAC_ENABLED controls role-based authorization
# - RLS_ENABLED controls row-level SQL filtering


# ============================================================================
# Feature Toggles (Aspect-Oriented Architecture)
# Each toggle MUST fully disable its concern
# ============================================================================
ENABLE_LOGGING=true
ENABLE_AUDIT_LOGGING=true
ENABLE_RATE_LIMIT=false
ENABLE_GZIP_COMPRESSION=true
ENABLE_PERFORMANCE=true
ENABLE_TRAINING_PILOT=false


# ============================================================================
# JWT Configuration (USED ONLY IF AUTH_ENABLED=true)
# EasyData VALIDATES tokens – it NEVER issues them
# ============================================================================
JWT_ALGORITHM=HS256
# Allowed values:
# - HS256 (shared secret)
# - RS256 (public/private key)
# - ES256 (ECDSA)

JWT_SECRET_KEY=CHANGE_ME_STRONG_RANDOM_VALUE   >>> CHANGE ME <<<

# Optional (advanced / production setups)
JWT_PUBLIC_KEY=
JWT_JWKS_URL=

# Token validation
JWT_EXPIRATION_MINUTES=60
JWT_ISSUER=
JWT_AUDIENCE=

# HTTP header settings
JWT_HEADER_NAME=Authorization
JWT_HEADER_PREFIX=Bearer


# ============================================================================
# Authorization / RBAC
# ============================================================================
RBAC_ROLES_CLAIM=roles
RBAC_DEFAULT_ROLE=viewer
RBAC_ADMIN_ROLE=admin


# ============================================================================
# Row Level Security (RLS)
# ============================================================================
RLS_SCOPE_CLAIM=tenant_id

# Behavior when RLS claim is missing:
# - deny  -> block request
# - allow -> ignore RLS filtering
RLS_MISSING_SCOPE_BEHAVIOR=deny


# ============================================================================
# User / Business Database (READ-ONLY ACCESS REQUIRED)
# ============================================================================
ORACLE_CONNECTION_STRING=oracle+oracledb://MAJED:StrongPass123@10.10.10.10:1521/XEPDB1  >>> CHANGE ME <<<
#ORACLE_CONNECTION_STRING=oracle+oracledb://user:password@host:port/service  <<< CHANGE ME <<<

MSSQL_CONNECTION_STRING=


# Rules:
# - Only ONE connection string is used (based on DB_PROVIDER)
# - Database user MUST be read-only
# - NEVER store system logs here


# ============================================================================
# System Database (Logs / Audit / Metadata ONLY)
# ============================================================================
SYSTEM_DB_TYPE=sqlite
# Allowed values:
# - sqlite   (default, zero configuration)
# - postgres (future / large-scale)

SYSTEM_DB_PATH=./data/logs.db
# Used only when SYSTEM_DB_TYPE=sqlite


# ============================================================================
# Vector Store
# ============================================================================
VECTOR_STORE_PATH=./data/vectorstore

# Qdrant (used only if VECTOR_DB=qdrant)
QDRANT_URL=
QDRANT_API_KEY=


# ============================================================================
# Observability / Tracing / Alerts
# ============================================================================
# OpenTelemetry / SigNoz
OTEL_EXPORTER_OTLP_ENDPOINT=
OTEL_SAMPLER_RATIO=1.0
OTEL_SERVICE_NAME=easydata-backend
ENABLE_SIGNOZ_ALERTS=false
SENTRY_API_TOKEN=
SENTRY_ORG_SLUG=
SENTRY_PROJECT_SLUG=


# ============================================================================
# Sentry (Crash & Exception Tracking)
# ============================================================================
SENTRY_DSN=   >>> CHANGE ME <<<
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=1.0
SENTRY_ATTACH_STACKTRACE=true
SENTRY_ENABLE_OTEL_BRIDGE=true
# When enabled, Sentry events MUST include trace_id for correlation with SigNoz


# ============================================================================
# LLM Providers
# Provider used is selected by LLM_PROVIDER above
# ============================================================================

# -------------------------
# OpenAI
# -------------------------
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxxxxx   >>> CHANGE ME <<<
OPENAI_MODEL=gpt-4o-mini
OPENAI_TIMEOUT=30

# -------------------------
# Google
# -------------------------
GOOGLE_API_KEY=
GOOGLE_MODEL=gemini-1.5-pro

# -------------------------
# Ollama (Local LLM)
# -------------------------
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama3

# -------------------------
# OpenAI-Compatible (PHI-3, etc.)
# -------------------------
PHI3_BASE_URL=http://localhost:1234/v1
PHI3_MODEL=phi-3
PHI3_API_KEY=
PHI3_TIMEOUT=30

# -------------------------
# Groq
# -------------------------
GROQ_API_KEY=
GROQ_MODEL=llama-3.1-8b-instant
GROQ_TIMEOUT=30


# ============================================================================
# Shared LLM Controls (Deterministic Mode)
# ============================================================================
LLM_TEMPERATURE=0.1
# Allowed values:
# - 0.0 -> fully deterministic
# - 0.1 -> near-deterministic (DEFAULT, RECOMMENDED)

LLM_MAX_TOKENS=2048
LLM_REQUEST_TIMEOUT=60


# ============================================================================
# RAG / Vanna Controls
# ============================================================================
RAG_TOP_K=5
MAX_SQL_TOKENS=2000

# Security-related Vanna limits
VANNA_ALLOW_DDL=false
VANNA_MAX_ROWS=500


# ============================================================================
# Governed Semantic Cache (v16.5+)
# ============================================================================
SEMANTIC_CACHE_SIMILARITY_THRESHOLD=0.85
# Cache hit requires similarity >= threshold

SEMANTIC_CACHE_MAX_RESULTS=3
SEMANTIC_CACHE_TTL_SECONDS=3600

# Governance behavior on cache hit
# - revalidate -> re-check cached SQL against current policy (DEFAULT)
# - bypass     -> NOT ALLOWED IN PRODUCTION
SEMANTIC_CACHE_GOVERNANCE_MODE=revalidate

SEMANTIC_CACHE_STORE_SQL=true
SEMANTIC_CACHE_STORE_RESULTS=true

# Redis URL for Authoritative SQL Store
REDIS_URL=redis://localhost:6379/0  >>> CHANGE ME <<<
# ============================================================================
# Admin Feature Toggle Governance (v16.7)
# ============================================================================
# Feature toggles MUST NOT be changed from UI directly
# All changes go through Admin API only
ADMIN_FEATURE_TOGGLE_API_ENABLED=true

# Require reason & audit log on every change
ADMIN_FEATURE_TOGGLE_REQUIRE_REASON=true

# Emit OpenTelemetry span on every toggle change
ADMIN_FEATURE_TOGGLE_EMIT_OTEL=true


# ============================================================================
# Arabic NLP Pipeline (v16.7)
# ============================================================================
ENABLE_ARABIC_NLP=true

# Normalization / Morphology
ENABLE_CAMEL_TOOLS=true

# Segmentation / Diacritization
ENABLE_FARASA=true
FARASA_MODEL_PATH=   >>> CHANGE ME <<<

# Embeddings for Arabic semantic search
ARABIC_EMBEDDING_MODEL=CAMeL-Lab/bert-base-arabic-camelbert-da

# Apply Arabic preprocessing before:
# - semantic cache lookup
# - embedding generation
# - Vanna SQL generation
ARABIC_PREPROCESS_BEFORE_RAG=true


# ============================================================================
# RAG Quality Governance (RAGAS – v16.6+)
# ============================================================================
ENABLE_RAGAS_EVALUATION=true

# Metrics to compute (comma-separated)
RAGAS_METRICS=context_precision,context_recall,faithfulness,answer_relevance

# Execution mode
# - async   -> background job (RECOMMENDED)
# - offline -> manual batch
RAGAS_EXECUTION_MODE=async

# Link results to audit_logs
RAGAS_LINK_TO_AUDIT_LOG=true


# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_SCOPE=user
# Allowed values:
# - user
# - ip
# - global


# ============================================================================
# Health Checks
# ============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TIMEOUT=5

# Aggregation strategy:
# - strict   -> any failure = unhealthy
# - degraded -> partial failure allowed
HEALTH_AGGREGATION_MODE=degraded


# ============================================================================
# End of File
# ============================================================================
