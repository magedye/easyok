# ============================================================================
# EasyData – Environment Configuration (REFERENCE TEMPLATE)
# ============================================================================
# GOVERNANCE NOTICE
# -----------------
# This file is the SINGLE SOURCE OF TRUTH for environment structure.
#
# Usage:
#   1. Copy this file to `.env`
#   2. Modify ONLY variables explicitly marked with:
#        >>> CHANGE ME <<<
#
# SECURITY RULES
# --------------
# - This file MUST NOT contain real secrets
# - All secrets are injected via `.env` only
# - Any violation is a governance breach
# ============================================================================


# ============================================================================
# Application
# ============================================================================
APP_NAME=EasyData

# Informational only (non-authoritative)
APP_VERSION=16.7.x

# Runtime environment
# Allowed values: development | staging | production
APP_ENV=development

# Debug mode
# GOVERNANCE RULE: MUST be false when APP_ENV=production
DEBUG=false

# Operation Tier
OPERATION_TIER=tier1_governed


# ============================================================================
# Core Provider Selectors (Single Source of Truth)
# DO NOT branch logic elsewhere
# ============================================================================
DB_PROVIDER=oracle
# Allowed values:
# - oracle
# - mssql

LLM_PROVIDER=groq
# Allowed values:
# - openai
# - google
# - ollama
# - openai_compatible
# - groq

VECTOR_DB=chromadb
# Allowed values:
# - chromadb
# - qdrant


ENABLE_SEMANTIC_CACHE=true


# ============================================================================
# Security Toggles
# ============================================================================
# AUTH_ENABLED=false means:
# - No authentication
# - JWT ignored
# - RBAC & RLS implicitly disabled
AUTH_ENABLED=false
RBAC_ENABLED=false
RLS_ENABLED=false
# Local-only admin bypass (explicit, disabled by default)
ENV=development
ADMIN_LOCAL_BYPASS=false


# ============================================================================
# Feature Toggles (Aspect-Oriented)
# Each toggle MUST fully disable its concern
# ============================================================================
ENABLE_LOGGING=true
ENABLE_AUDIT_LOGGING=true
ENABLE_RATE_LIMIT=false
ENABLE_GZIP_COMPRESSION=true
ENABLE_PERFORMANCE=true
ENABLE_TRAINING_PILOT=false


# ============================================================================
# JWT Configuration (USED ONLY IF AUTH_ENABLED=true)
# EasyData VALIDATES tokens – it NEVER issues them
# ============================================================================
JWT_ALGORITHM=HS256
# Allowed values:
# - HS256
# - RS256
# - ES256

JWT_SECRET_KEY=   >>> CHANGE ME <<<

# Optional / advanced
JWT_PUBLIC_KEY=
JWT_JWKS_URL=

JWT_EXPIRATION_MINUTES=60
JWT_ISSUER=
JWT_AUDIENCE=

JWT_HEADER_NAME=Authorization
JWT_HEADER_PREFIX=Bearer


# ============================================================================
# Authorization / RBAC
# ============================================================================
RBAC_ROLES_CLAIM=roles
RBAC_DEFAULT_ROLE=viewer
RBAC_ADMIN_ROLE=admin


# ============================================================================
# Row Level Security (RLS)
# ============================================================================
RLS_SCOPE_CLAIM=tenant_id

# Behavior when RLS claim is missing:
# - deny  -> block request
# - allow -> ignore RLS filtering
RLS_MISSING_SCOPE_BEHAVIOR=deny


# ============================================================================
# User / Business Database (READ-ONLY REQUIRED)
# ============================================================================
# Only ONE connection string is used (based on DB_PROVIDER)
# Database user MUST be read-only
ORACLE_USER=MAJED
ORACLE_PASSWORD=StrongPass123
ORACLE_HOST=10.10.10.10
ORACLE_PORT=1521
ORACLE_NAME=XEPDB1
ORACLE_DSN=10.10.10.10:1521/XEPDB1

ORACLE_CONNECTION_STRING=oracle+oracledb://user:password@host:port/service  >>> CHANGE ME <<<
VANNA_SQLRUNNER_DIALECT=oracle
VANNA_SQLRUNNER_CONNECTION=oracle+oracledb://user:password@host:port/service  >>> CHANGE ME <<<
MSSQL_CONNECTION_STRING=


# ============================================================================
# System Database (Logs / Audit / Metadata ONLY)
# ============================================================================
SYSTEM_DB_TYPE=sqlite
# Allowed values:
# - sqlite
# - postgres

SYSTEM_DB_PATH=./data/logs.db


# ============================================================================
# Vector Store
# ============================================================================
VECTOR_STORE_PATH=./data/vectorstore

# Qdrant (used only if VECTOR_DB=qdrant)
QDRANT_URL=
QDRANT_API_KEY=   >>> CHANGE ME <<<


# ============================================================================
# Observability / Tracing / Alerts
# ============================================================================
OTEL_EXPORTER_OTLP_ENDPOINT=
OTEL_SAMPLER_RATIO=1.0
OTEL_SERVICE_NAME=easydata-backend

ENABLE_SIGNOZ_ALERTS=false

SENTRY_API_TOKEN=   >>> CHANGE ME <<<
SENTRY_ORG_SLUG=
SENTRY_PROJECT_SLUG=


# ============================================================================
# Sentry (Crash & Exception Tracking)
# ============================================================================
SENTRY_DSN=   >>> CHANGE ME <<<
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=1.0
SENTRY_ATTACH_STACKTRACE=true
SENTRY_ENABLE_OTEL_BRIDGE=true

CORS_ORIGINS=["http://localhost:5173","http://localhost:5174","http://localhost:5175","http://10.10.10.10:5173","http://10.10.10.10:5174","http://10.10.10.10:5175"]


# ============================================================================
# LLM Providers
# ============================================================================
# Provider used is selected by LLM_PROVIDER above

# -------------------------
# OpenAI
# -------------------------
OPENAI_API_KEY=   >>> CHANGE ME <<<
OPENAI_MODEL=gpt-4o-mini
OPENAI_TIMEOUT=30

# -------------------------
# Google
# -------------------------
GOOGLE_API_KEY=   >>> CHANGE ME <<<
GOOGLE_MODEL=gemini-1.5-pro

# -------------------------
# Ollama
# -------------------------
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama3

# -------------------------
# OpenAI-Compatible
# -------------------------
PHI3_BASE_URL=http://localhost:1234/v1
PHI3_MODEL=phi-3
PHI3_API_KEY=   >>> CHANGE ME <<<
PHI3_TIMEOUT=30

# -------------------------
# Groq
# -------------------------
GROQ_API_KEY=   >>> CHANGE ME <<<
GROQ_MODEL=llama-3.1-8b-instant
GROQ_BASE_URL=https://api.groq.com/openai/v1
GROQ_TIMEOUT=30


# ============================================================================
# Shared LLM Controls (Deterministic Mode)
# ============================================================================
LLM_TEMPERATURE=0.1
LLM_MAX_TOKENS=2048
LLM_REQUEST_TIMEOUT=60


# ============================================================================
# RAG / Vanna Controls
# ============================================================================
RAG_TOP_K=5
MAX_SQL_TOKENS=2000

VANNA_ALLOW_DDL=false
VANNA_MAX_ROWS=500
VANNA_DEFAULT_LIMIT=100
VANNA_MAX_EXECUTION_TIME=30
VANNA_RATE_LIMIT_REQUESTS=100
VANNA_RATE_LIMIT_WINDOW=3600
VANNA_ENABLE_FEEDBACK=true
VANNA_ENABLE_MEMORY=true
VANNA_ENABLE_RICH_OUTPUT=true
VANNA_ENABLE_CHARTS=true
VANNA_DRY_RUN_MODE=false


# ============================================================================
# Governed Semantic Cache
# ============================================================================
SEMANTIC_CACHE_SIMILARITY_THRESHOLD=0.85
SEMANTIC_CACHE_MAX_RESULTS=3
SEMANTIC_CACHE_TTL_SECONDS=3600

# Governance behavior:
# - revalidate (DEFAULT, REQUIRED)
SEMANTIC_CACHE_GOVERNANCE_MODE=revalidate

SEMANTIC_CACHE_STORE_SQL=true
SEMANTIC_CACHE_STORE_RESULTS=true

REDIS_URL=redis://localhost:6379/0  >>> CHANGE ME <<<


# ============================================================================
# Admin Feature Toggle Governance (v16.7)
# ============================================================================
ADMIN_FEATURE_TOGGLE_API_ENABLED=true
ADMIN_FEATURE_TOGGLE_REQUIRE_REASON=true
ADMIN_FEATURE_TOGGLE_EMIT_OTEL=true


# ============================================================================
# Arabic NLP Pipeline (v16.7)
# ============================================================================
ENABLE_ARABIC_NLP=true
ENABLE_CAMEL_TOOLS=true
ENABLE_FARASA=true

FARASA_MODEL_PATH=   >>> CHANGE ME <<<

ARABIC_EMBEDDING_MODEL=CAMeL-Lab/bert-base-arabic-camelbert-da
ARABIC_PREPROCESS_BEFORE_RAG=true


# ============================================================================
# RAG Quality Governance (RAGAS)
# ============================================================================
ENABLE_RAGAS_EVALUATION=true

RAGAS_METRICS=context_precision,context_recall,faithfulness,answer_relevance
RAGAS_EXECUTION_MODE=async
RAGAS_LINK_TO_AUDIT_LOG=true
ENABLE_RAG_QUALITY=false


# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_SCOPE=user
# Allowed values:
# - user
# - ip
# - global


# ============================================================================
# Health Checks
# ============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TIMEOUT=5

HEALTH_AGGREGATION_MODE=degraded
# Allowed values:
# - strict
# - degraded


# ============================================================================
# End of File
# ============================================================================
