# =============================================================================
# EasyData — Environment Schema (.env.schema)
# =============================================================================
# GOVERNANCE: MASTER CONFIGURATION
# --------------------------------
# This file defines the SUPERSET of all environment variables used in the system.
#
# RULES:
# - SAFE DEFAULTS ONLY (Production-ready settings)
# - NO SECRETS (Keys/Passwords must be empty)
# - NO BYPASSES (Security checks defaults to true)
# - MUST be committed to Git
# =============================================================================


# =============================================================================
# Environment & Identity
# =============================================================================
ENV=production
# Allowed: local | ci | production

APP_ENV=production
# Allowed: development | staging | production

APP_NAME=EasyData
APP_VERSION=16.7.x
DEBUG=false


# =============================================================================
# Core Provider Selectors
# =============================================================================
DB_PROVIDER=oracle
# Allowed: oracle | mssql

LLM_PROVIDER=groq
# Allowed: openai | google | ollama | openai_compatible | groq

VECTOR_DB=chromadb
# Allowed: chromadb | qdrant


# =============================================================================
# Operation Tier (Single Switch)
# =============================================================================
OPERATION_TIER=tier1_governed
# Allowed: tier0_fortress | tier1_governed | tier2_vanna


# =============================================================================
# Security Toggles (SAFE DEFAULTS)
# =============================================================================
AUTH_ENABLED=true
RBAC_ENABLED=true
RLS_ENABLED=true
ADMIN_LOCAL_BYPASS=false


# =============================================================================
# Feature Toggles
# =============================================================================
ENABLE_LOGGING=true
ENABLE_AUDIT_LOGGING=true
ENABLE_RATE_LIMIT=true
ENABLE_GZIP_COMPRESSION=true
ENABLE_PERFORMANCE=true
ENABLE_TRAINING_PILOT=false
TRAINING_READINESS_ENFORCED=true
ENABLE_RAG_QUALITY=false
EASYDATA_ALLOW_LOCAL_NO_SCHEMA_POLICY=false


# =============================================================================
# JWT Configuration
# =============================================================================
JWT_ALGORITHM=HS256
JWT_SECRET_KEY=

JWT_PUBLIC_KEY=
JWT_JWKS_URL=

JWT_EXPIRATION_MINUTES=60
JWT_ISSUER=
JWT_AUDIENCE=

JWT_HEADER_NAME=Authorization
JWT_HEADER_PREFIX=Bearer


# =============================================================================
# RBAC & Authorization
# =============================================================================
RBAC_ROLES_CLAIM=roles
RBAC_DEFAULT_ROLE=viewer
RBAC_ADMIN_ROLE=admin


# =============================================================================
# Row Level Security (RLS)
# =============================================================================
RLS_SCOPE_CLAIM=tenant_id
RLS_MISSING_SCOPE_BEHAVIOR=deny


# =============================================================================
# User / Business Database
# =============================================================================
# Option A: Full Connection Strings
ORACLE_CONNECTION_STRING=
MSSQL_CONNECTION_STRING=

# Option B: Granular Components (Added from Reference Template)
ORACLE_USER=
ORACLE_PASSWORD=
ORACLE_DSN=


# =============================================================================
# System Database
# =============================================================================
SYSTEM_DB_TYPE=sqlite
SYSTEM_DB_PATH=./data/logs.db


# =============================================================================
# Vector Store
# =============================================================================
VECTOR_STORE_PATH=./data/vectorstore

QDRANT_URL=
QDRANT_API_KEY=


# =============================================================================
# Observability & Tracing
# =============================================================================
ENABLE_TELEMETRY=true
ANON_TELEMETRY=true
ENABLE_OTEL=true

OTEL_EXPORTER_OTLP_ENDPOINT=
OTEL_SAMPLER_RATIO=1.0
OTEL_SERVICE_NAME=easydata-backend

ENABLE_SIGNOZ_ALERTS=false


# =============================================================================
# Sentry (Runtime & Release Management)
# =============================================================================
# Runtime Config
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=1.0
SENTRY_ATTACH_STACKTRACE=true
SENTRY_ENABLE_OTEL_BRIDGE=true

# Build/Release Config (Added from Reference Template)
SENTRY_API_TOKEN=
SENTRY_ORG_SLUG=
SENTRY_PROJECT_SLUG=


# =============================================================================
# LLM Providers
# =============================================================================
# OpenAI
OPENAI_API_KEY=
OPENAI_MODEL=
OPENAI_BASE_URL=
OPENAI_TIMEOUT=30

# Google
GOOGLE_API_KEY=
GOOGLE_MODEL=gemini-1.5-pro

# Ollama
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama3

# Groq
GROQ_API_KEY=
GROQ_MODEL=llama-3.1-8b-instant
GROQ_TIMEOUT=30

# OpenAI-Compatible / Phi3 (Added from Reference Template)
PHI3_BASE_URL=
PHI3_MODEL=phi-3
PHI3_API_KEY=
PHI3_TIMEOUT=30


# =============================================================================
# Shared LLM Controls
# =============================================================================
LLM_TEMPERATURE=0.1
LLM_MAX_TOKENS=2048
LLM_REQUEST_TIMEOUT=60


# =============================================================================
# RAG / Vanna Controls
# =============================================================================
RAG_TOP_K=5
MAX_SQL_TOKENS=2000

VANNA_ALLOW_DDL=false
VANNA_MAX_ROWS=500


# =============================================================================
# Tier 2 — Vanna Native Settings
# =============================================================================
VANNA_LLM_PROVIDER=ollama
# Allowed: ollama | openai | openai_compatible | google | groq
VANNA_LLM_MODEL=neural-chat
VANNA_LLM_ENDPOINT=http://localhost:11434

VANNA_SQLRUNNER_DIALECT=postgres
# Allowed: oracle | mssql | postgres | sqlite
VANNA_SQLRUNNER_CONNECTION=

VANNA_MEMORY_TYPE=in_memory
# Allowed: in_memory | postgres | redis | chroma

VANNA_SYSTEM_PROMPT_TEMPLATE=You are an expert data analyst assistant.\\n- Always explain your reasoning\\n- Prefer explicit column names\\n- Limit results to 100 unless asked\\n- Use EXPLAIN for complex queries

VANNA_DEFAULT_LIMIT=100
VANNA_MAX_EXECUTION_TIME=30
VANNA_RATE_LIMIT_REQUESTS=100
VANNA_RATE_LIMIT_WINDOW=3600

VANNA_ENABLE_FEEDBACK=true
VANNA_ENABLE_MEMORY=true
VANNA_ENABLE_RICH_OUTPUT=true
VANNA_ENABLE_CHARTS=true
VANNA_DRY_RUN_MODE=false


# =============================================================================
# Governed Semantic Cache
# =============================================================================
ENABLE_SEMANTIC_CACHE=false

SEMANTIC_CACHE_SIMILARITY_THRESHOLD=0.85
SEMANTIC_CACHE_MAX_RESULTS=3
SEMANTIC_CACHE_TTL_SECONDS=3600
SEMANTIC_CACHE_GOVERNANCE_MODE=revalidate

SEMANTIC_CACHE_STORE_SQL=true
SEMANTIC_CACHE_STORE_RESULTS=true

REDIS_URL=


# =============================================================================
# Admin Feature Governance
# =============================================================================
ADMIN_FEATURE_TOGGLE_API_ENABLED=true
ADMIN_FEATURE_TOGGLE_REQUIRE_REASON=true
ADMIN_FEATURE_TOGGLE_EMIT_OTEL=true


# =============================================================================
# Arabic NLP Pipeline
# =============================================================================
ENABLE_ARABIC_NLP=true
ENABLE_CAMEL_TOOLS=true
ENABLE_FARASA=false

FARASA_MODEL_PATH=

ARABIC_EMBEDDING_MODEL=CAMeL-Lab/bert-base-arabic-camelbert-da
ARABIC_PREPROCESS_BEFORE_RAG=true


# =============================================================================
# RAG Quality Governance (RAGAS)
# =============================================================================
ENABLE_RAGAS_EVALUATION=false

RAGAS_METRICS=context_precision,context_recall,faithfulness,answer_relevance
RAGAS_EXECUTION_MODE=async
RAGAS_LINK_TO_AUDIT_LOG=true


# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_SCOPE=user


# =============================================================================
# Health Checks
# =============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_TIMEOUT=5
HEALTH_AGGREGATION_MODE=degraded


# =============================================================================
# API Server / Runtime Controls (Required by code)
# =============================================================================
BACKEND_PORT=8000
CORS_ORIGINS=[]
STREAM_PROTOCOL=ndjson
DEFAULT_ROW_LIMIT=100


# =============================================================================
# Sandbox / Shadow Execution (Required by code)
# =============================================================================
SANDBOX_DATA_STRATEGY=schema_only
SANDBOX_SENSITIVE_COLUMNS=[]


# =============================================================================
# End of Schema
# =============================================================================
