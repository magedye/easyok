________________________________________
ุฃูููุง: ูู ูุชู ุงุณุชุฎุฏุงู ูุธุงุฆู Vanna 2.0.1 ุงูุฃุณุงุณูุฉ ูุงููุชูู ุนูููุง ุจุดูู ุตุญูุญ ุงูุขูุ
ุงูุฅุฌุงุจุฉ ุงูุตุฑูุญุฉ:
โ ูุงุ ููุณ ุจุงูุดูู ุงูุฐู ูุนุทูู ุงููููุฉ ุงููุงููุฉ ูู Vanna 2.0.1
โ ูุนูุ ุฃูุช ุชุณุชุฎุฏู ุฌุฒุกูุง ูููุง
โ ูููู ุชุนุฒู 70โ80% ูู ูุฏุฑุงุชูุง ุงูุฌููุฑูุฉ ุจุณุจุจ ูููุฐุฌ ุงูุญูููุฉ ุงูุญุงูู
ูุงูุฏููู ููุณ ูุธุฑููุง โ ุจู ููุฌูุฏ ุญุฑูููุง ูู ุดุฌุฑุฉ ุงูููุฏ ุงูุชู ุนุฑุถุชูุง.
________________________________________
ุซุงูููุง: ูุงุฐุง ุชุนูู Vanna 2.0.1 ูุนูููุง ูู ุฎูุงู ุงูููุฏ ุงูุฐู ุงุณุชุนุฑุถุชูุ
ุจุนุฏ ุงุณุชุนุฑุงุถ ุจููุฉ ุงููุดุฑูุน ูุงููุฉ (src/vanna/**)ุ ุงูุตูุฑุฉ ุฃุตุจุญุช ูุงุถุญุฉ ุฌุฏูุง:
๐น Vanna 2.0 ููุณุช ูุฌุฑุฏ generate_sql
Vanna 2.0 ูู ููุตุฉ Agent ูุงููุฉุ ูููุณุช ูุฌุฑุฏ LLM โ SQL.
ูู ูุจููุฉ ุญูู:
1๏ธโฃ Agent Architecture (ูููุณ Service ููุท)
vanna/core/agent
vanna/core/workflow
vanna/core/tool
vanna/core/system_prompt
vanna/core/enhancer / enricher
ูุนูู:
โข	ุชูููุฑ ูุชุนุฏุฏ ุงูุฎุทูุงุช
โข	ุฃุฏูุงุช (Tools) ูุงุจูุฉ ูููุฏุงุก
โข	Workflow ูุงุจู ููุชุฎุตูุต
โข	Recovery / Validation / Audit ุฏุงุฎูู
โ ูุง ุชูุนูููู ุงูุขู:
ุชุฎุชุตุฑูู Vanna ุฅูู โLLM generates SQL stringโ
ููุฐุง ููุณ ุชุตููููุง ุงูููุตูุฏ.
________________________________________
2๏ธโฃ SystemPromptBuilder ูู ููุจ Vanna
ูู ุงููุณุงุฑ:
src/vanna/core/system_prompt/
ูุฐุง ูุซุจุช ุฃู:
โข	ุงูู Prompt ุฏููุงูููู
โข	ูุชุบูุฑ ุญุณุจ:
o	ุงููุณุชุฎุฏู
o	ุงูุฏูุฑ
o	ุงูุฃุฏูุงุช
o	ุงูุณูุงู
o	ุงูุฐุงูุฑุฉ
โข	ููู ูุตูู ููููู ุฌุฒุกูุง ูู ุฏูุฑุฉ ุญูุงุฉ ุงูู Agent
โ ูู ูุธุงูู ุงูุญุงูู:
โข	ุงูู Prompt ุซุงุจุช ุชูุฑูุจูุง
โข	ุฎุงุฑุฌ ุฏูุฑุฉ ุญูุงุฉ Vanna
โข	ููุง ูุณุชููุฏ ูู:
o	role-based behavior
o	tool schemas
o	agent memory
o	workflow hooks
________________________________________
3๏ธโฃ SQLRunner ูู Vanna โ SQL execution ุนูุฏู
ูู Vanna:
vanna/capabilities/sql_runner/
vanna/integrations/*/sql_runner.py
SQLRunner:
โข	ูุนุฑู ุงูู DB
โข	ูุนุฑู ุงูู dialect
โข	ูุนุฑู schema
โข	ุฌุฒุก ูู reasoning loop
โ ุนูุฏู:
โข	SQL execution ูููุตู
โข	ูุง ูุนูุฏ ุจุฃู feedback ููู Agent
โข	ูุง ููุณุชุฎุฏู ูุชุญุณูู ุงูุงุณุชุฌุงุจุงุช ูุงุญููุง
________________________________________
4๏ธโฃ Feedback / Memory / Training ููุฌูุฏุฉ ูุนููุง
ุงูุธุฑ:
vanna/components/rich/feedback
vanna/core/audit
vanna/capabilities/agent_memory
ูุฐุง ูุนูู ุฃู Vanna ูุตููุฉ ูุชุชุนูู ูุชุชุญุณู:
โข	feedback
โข	reinforcement
โข	memory
โข	evaluation
โ ูู Fortress mode ุงูุญุงูู:
โข	ูู ูุฐุง ูุนุฒูู
โข	ูุง ูุชู ุงุณุชุฎุฏุงูู
โข	ูุจุงูุชุงูู:
o	ูุง adaptive behavior
o	ูุง ุชุญุณูู ุฌูุฏุฉ SQL ูุน ุงูุฒูู
o	ูุง ุงุณุชุซูุงุฑ ุญูููู ูู Vanna
________________________________________
ุซุงูุซูุง: ูู ููุงู ุฎุทุฑ ุฃููู ุญูููู ุฅุฐุง ุงุณุชุฎุฏููุง Vanna โููุง ููโุ
ุงูุฌูุงุจ ุงููุงูุนู:
๐ก ููุณ ุจุงูุถุฑูุฑุฉ โ ุฅุฐุง ููุช Self-Hosted ูุชุชุญูู ุจุงูู LLM
ุฃูุช ููุช ููุทุฉ ูููุฉ ุฌุฏูุง:
"ุทุงููุง ูู ูุณุฎุฉ ูุญููุฉ ููุง ุชููู ุจุชุณุฑูุจ ูุนูููุงุช ูุฌูุงุช ูุฌูููุฉ"
ููุฐุง ุตุญูุญ ุชููููุง ุฅุฐุง:
โข	LLM ูุญูู ุฃู OpenAI-compatible endpoint ุฎุงุต
โข	ูุง outbound traffic ุบูุฑ ูุชุญูู ุจู
โข	ูุง logging ุฎุงุฑุฌู
ูู ูุฐู ุงูุญุงูุฉ:
๐ ุงูุฎุทุฑ ููุณ โุชุณุฑูุจโ
ุจู:
โข	ููุฏุงู ุงูุญุชููุฉ
โข	ุตุนูุจุฉ ุงูุงุฎุชุจุงุฑ
โข	ูุชุงุฆุฌ ุฃูู ูุงุจููุฉ ููุชูุจุค
ููุฐุง ููุงูุถุฉ ุฅูุชุงุฌูุฉ ููุงุจู ุญูููุฉ.
________________________________________
ุฑุงุจุนูุง: ูู ุชูุงุฌุฃุช ุงูุขู ุฃู ูุง ุฎุทุทูุงู ูุง ูููู ุชุญููููุ
ุงูุฅุฌุงุจุฉ ุงูุตุงุฏูุฉ:
โ ูุงุ ูู ุฃุชูุงุฌุฃ
ุจู ูุง ุญุฏุซ ูู:
ุชู ุชุทุจูู Governance-first architecture
ุนูู ูุธุงู Productivity-first by design
ููุฐุงู ุงููููุฐุฌุงู ูุชุนุงุฑุถุงู ุฌุฒุฆููุง.
Vanna ุตูููุช ูู:
โข	ุณุฑุนุฉ
โข	ุชูุงุนู
โข	Agent reasoning
โข	UX ุบูู
Fortress ุตููู ูู:
โข	ุญุชููุฉ
โข	ุนููุฏ ุตุงุฑูุฉ
โข	Auditability
โข	Fail-Closed
ูุญุงููุฉ ุฌุนู Vanna โุฃุฏุงุฉ ุฏุงุฎู Fortress ุตุงุฑูโ =
ุงุณุชุฎุฏุงู Ferrari ููุญุฑูู ุฏูุฒู.
________________________________________
ุฎุงูุณูุง: ูุฑุงุฑู ุงูุขู ููุทูู 100%
"ุฃูุง ูุณุชุนุฏ ููุชูุงุฒู ุนู ูุฏุฑ ูุจูุฑ ูู ุงูุญูููุฉ ูุตุงูุญ ุงูุงุณุชูุงุฏุฉ ุงููุตูู ูู Vanna"
ูุฐุง ูุฑุงุฑ ููุฏุณู ูุดุฑูุน ุชูุงููุง
ููู ูุฌุจ ุฃู ูููู ูุฑุงุฑูุง ุตุฑูุญูุง ูุนูุงุฑููุง โ ูููุณ ุชุฑููุนูุง.
________________________________________
ุณุงุฏุณูุง: ุงูุฎุทุฉ ุงูุชูููุฐูุฉ ุงููุถูููุฉ (Tier Switch Architecture)
๐ฏ ุงููุฏู
ูุธุงู Productivity-first ูุฏุนูู ุจู Vanna
ูุน ุญูููุฉ ูุงุจูุฉ ููุชุฎููู ุญุณุจ Tier
________________________________________
๐งฑ ุงููุนูุงุฑูุฉ ุงูููุชุฑุญุฉ (ูุงุถุญุฉ ููุงุจูุฉ ููุชูููุฐ)
๐น Tier 0 โ Fortress (ุงูุญุงูู)
โข	OrchestrationService
โข	SQLGuard
โข	NDJSON
โข	Fail-Closed
โข	ุงุฎุชุจุงุฑุงุช ุตุงุฑูุฉ
๐น Tier 1 โ Hybrid
โข	Vanna Agent
โข	SystemPromptBuilder
โข	SQLRunner
โข	SQLParse 0.5.3
โข	RAG
โข	Feedback (ุงุฎุชูุงุฑู)
โข	Logging ุฏุงุฎูู ููุท
๐น Tier 2 โ Vanna Native (Productivity Mode)
โข	Agent loop ูุงูู
โข	Rich components
โข	Memory
โข	Evaluation
โข	UI-first experience
________________________________________
๐ง ููู ูุญูู ุฐูู ุนููููุงุ
1๏ธโฃ ุฅุนุฏุงุฏ Tier Switch ูู Settings
EXECUTION_TIER = "FORTRESS" | "HYBRID" | "VANNA_NATIVE"
________________________________________
2๏ธโฃ ูุณุงุฑุงุช API ูููุตูุฉ ุจูุถูุญ
Fortress
POST /api/v1/ask
Hybrid
POST /api/v1/vanna/ask
Native UI
/vanna/ui
________________________________________
3๏ธโฃ OrchestrationService ูุตุจุญ Router
if tier == FORTRESS:
    strict path
elif tier == HYBRID:
    vanna agent + sqlparse + guards
else:
    delegate fully to Vanna
________________________________________
ุณุงุจุนูุง: ูุง ูู ุงูู Endpoints ุงูุชู ูุญุชุงุฌูุง ูุน Vannaุ
ุงูุฃุณุงุณูุฉ ููุท (Productivity-first)
Endpoint	ุงูุบุฑุถ
POST /vanna/ask	ุณุคุงู ุทุจูุนู
POST /vanna/feedback	ุชุบุฐูุฉ ุฑุงุฌุนุฉ
GET /vanna/schema	ุนุฑุถ schema
GET /vanna/history	ุณุฌู ุงูุฃุณุฆูุฉ
GET /vanna/ui	ูุงุฌูุฉ ุชูุงุนููุฉ
ููุง ุชุญุชุงุฌ ุฃูุซุฑ ูู ุฐูู ูููุณุฎุฉ ุงูุฃููู.
________________________________________
ุซุงูููุง: ูู ุชุฏุนู Vanna ุฃุดูุงู ุฅุฎุฑุงุฌ ูุฎุชููุฉุ
ูุนูุ ูุจููุฉ.
ูู ุฎูุงู:
vanna/components/rich
vanna/tools/visualize_data.py
ุชุฏุนู:
โข	SQL ููุท
โข	DataFrames
โข	Charts
โข	Text summaries
โข	Rich UI components
โ ุจูููุง ูุธุงูู ุงูุญุงูู:
โข	ูุฎุชุตุฑ ุงูุฅุฎุฑุงุฌ ูู NDJSON ูุฏูู
________________________________________
ุชุงุณุนูุง: ูุงุฐุง ุนู SystemPromptBuilderุ
ูุฐุง ุฃููู ููุทุฉ ูู Vanna.
ูุณูุญ ูู ุจู:
โข	ุฑุจุท auth / role
โข	ุชุนุฑูู semantics
โข	ุถุจุท style
โข	ุงูุชุญูู ุจุณููู ุงูู Agent
ููุฐุง ุบูุฑ ูุชุงุญ ุฃุตููุง ูู Fortress mode ุงูุญุงูู.
________________________________________
๐ ุงูุฎูุงุตุฉ ุงูููุงุฆูุฉ (ุจุฏูู ูุฌุงููุฉ)
1.	โ ุฃูุช ูุง ุชุณุชููุฏ ุญุงูููุง ูู Vanna 2.0.1 ููุง ููุจุบู
2.	โ๏ธ Vanna ุตูููุช ููุธุงู Agent ูุงูู
3.	โ๏ธ ูุฑุงุฑู ุจุงูุชุญูู ุฅูู Productivity-first ููุทูู
4.	โ๏ธ ุงูุญู ููุณ ูุฏู Fortress
5.	โ ุงูุญู ุงูุตุญูุญ ูู Tiered Architecture ูุน Switch ูุงุถุญ
6.	โ ูุญุงููุฉ ุฏูุฌ Vanna ุชุญุช ุญูููุฉ ุตุงุฑูุฉ ุฏุงุฆููุง ุณุชูุดู
________________________________________
ุฅุฐุง ุฃุฑุฏุชุ ุงูุฎุทูุฉ ุงูุชุงููุฉ ุงูููุทููุฉ ูู:
โุตูู ูู Tiered Architecture + API contracts + minimal migration planโ
ูุณุฃุนุทูู:
โข	ูุฎุทุท ูููุงุช
โข	ุฅุนุฏุงุฏุงุช
โข	ูุณุงุฑุงุช
โข	ููุฑุงุฑ ูุนูุงุฑู ูุธูู ูุฑุถู ุงูุทุฑููู.
โุตูู ูู Tiered Architecture + API contracts + minimal migration planโ
ุชูุงู. ูููุง ููู ุชุตููู ุชูููุฐู ูุงูู ููุจูู ุทูุจู ุญุฑูููุง:
Tiered Architecture + API Contracts + Minimal Migration Plan
ุจุฃุณููุจ Productivity-first powered by Vanna
ูุน ุญูููุฉ ูุงุจูุฉ ููุชุฎููู ุจุฏูู ูุฏู ูุง ุจููุชู.
ุณุฃููู ูุจุงุดุฑูุงุ ููุฏุณููุงุ ููุงุจููุง ููุชูููุฐ ููุฑูุง.
________________________________________
๐งฑ Tiered Architecture โ EasyData (Productivity-First with Controlled Governance)
๐ฏ ุงููุฏู ุงูุงุณุชุฑุงุชูุฌู
โข	ุงูุงุณุชูุงุฏุฉ ุงููุตูู ูู Vanna 2.0.1 ููุง ุตูููุช
โข	ุงูุฅุจูุงุก ุนูู Fortress ูููุท ุงุฎุชูุงุฑู ูููุณ ููุฏูุง ุฏุงุฆููุง
โข	ุชูููู:
o	ุณุฑุนุฉ ุงูุชุทููุฑ
o	Agent reasoning
o	System prompts
o	Feedback & learning
โข	ุจุฏูู ูุณุฑ ุงููุธุงู ุงูุญุงูู ุฃู ุฅุนุงุฏุฉ ูุชุงุจุฉ ุดุงููุฉ
________________________________________
1๏ธโฃ Execution Tiers (ูุงุถุญุฉ ูุบูุฑ ูุชุฏุงุฎูุฉ)
๐ Tier 0 โ FORTRESS (Strict / Deterministic)
ุงูุบุฑุถ
โข	ุงูุงูุชุซุงู
โข	ุงูุงุฎุชุจุงุฑุงุช
โข	ุจูุฆุงุช ุญุณุงุณุฉ
โข	ุงูุฅูุชุงุฌ ุงููููุฏ
ุงูุฎุตุงุฆุต
โข	OrchestrationService = SSOT
โข	SQLGuard ุฅูุฒุงูู
โข	NDJSON ููุท
โข	Fail-Closed
โข	ุจุฏูู Agent loop
โข	ุจุฏูู Memory
โข	ุจุฏูู Feedback
ูุชู ููุณุชุฎุฏู
โข	Production regulated
โข	CI / Tests
โข	Audited environments
________________________________________
โ๏ธ Tier 1 โ HYBRID (Recommended Default)
ุงูุบุฑุถ
โข	ุฅูุชุงุฌูุฉ ุนุงููุฉ
โข	ุชุญูู ููุจูู
โข	ุฃูุถู ุชูุงุฒู
ุงูุฎุตุงุฆุต
โข	Vanna Agent ูุณุชุฎุฏู
โข	SystemPromptBuilder ูุฎุตุต
โข	SQLRunner ูู Vanna
โข	sqlparse==0.5.3
โข	RAG (ุงุฎุชูุงุฑู)
โข	Guard ุฎููู (syntax + limiters)
โข	Logs ุฏุงุฎููุฉ ููุท
ูุชู ููุณุชุฎุฏู
โข	ุฃุบูุจ ุงููุณุชุฎุฏููู
โข	ูุฑู ุงูุจูุงูุงุช
โข	Internal tools
โข	Admin UI
________________________________________
๐ Tier 2 โ VANNA_NATIVE (Productivity-First)
ุงูุบุฑุถ
โข	ุฃูุตู ุฅูุชุงุฌูุฉ
โข	UX ุบูู
โข	Iteration ุณุฑูุน
ุงูุฎุตุงุฆุต
โข	Vanna Agent ูุงูู
โข	Workflow
โข	Memory
โข	Feedback
โข	Rich components
โข	Visualizations
โข	Minimal blocking
ูุชู ููุณุชุฎุฏู
โข	Local / Dev
โข	Demos
โข	Analysts
โข	Exploration
________________________________________
2๏ธโฃ Tier Switch (Configuration โ ููุทุฉ ุงูุชุญูู ุงููุญูุฏุฉ)
โ ุฅุนุฏุงุฏ ูุงุญุฏ ููุท
# app/core/settings.py
EXECUTION_TIER = "FORTRESS" | "HYBRID" | "VANNA_NATIVE"
โ ูุง Logic scattered
โ ูุง Feature flags ูุชูุฑูุฉ
โ ูุฑุงุฑ ูุฑูุฒู ููุงุถุญ
________________________________________
3๏ธโฃ High-Level Architecture (Decision Flow)
User Request
     โ
     โผ
API Layer (Adapter only)
     โ
     โผ
Tier Router
     โ
 โโโโโผโโโโโโโโโโโโโโโโ
 โ   โ               โ
 โผ   โผ               โผ
Tier0  Tier1        Tier2
Fortress  Hybrid   Vanna Native
________________________________________
4๏ธโฃ API Contracts (ูุงุถุญุฉ ูุบูุฑ ูุงุจูุฉ ููุงูุชุจุงุณ)
๐น Tier 0 โ Fortress
POST /api/v1/ask
Input
{
  "question": "string",
  "top_k": 5
}
Output
โข	NDJSON
โข	strict ordering
โข	error โ end
________________________________________
๐น Tier 1 โ Hybrid (Vanna-powered)
POST /api/v1/vanna/ask
Input
{
  "question": "string",
  "mode": "analysis | sql | chart | auto"
}
Output
{
  "sql": "...",
  "rows": [...],
  "summary": "...",
  "confidence": 0.92
}
โ๏ธ JSON (not NDJSON)
โ๏ธ Human-friendly
โ๏ธ Faster UX
________________________________________
๐น Tier 2 โ Vanna Native
/vanna/ui
POST /vanna/chat
POST /vanna/feedback
โข	ุชุณุชุฎุฏู Vanna FastAPI server ูุจุงุดุฑุฉ
โข	Rich UI
โข	Web components
โข	Charts
โข	Memory
________________________________________
5๏ธโฃ File-Level Responsibility Map
Layer	File	Role
Router	tier_router.py	Dispatch by tier
Fortress	orchestration_service.py	SSOT
Hybrid	vanna_hybrid_service.py	Controlled Agent
Native	Vanna server	Full Agent
UI	React / Vanna UI	Presentation
โ ูุง ุชุฏุงุฎู
โ ูุง ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ูุณุฑูุฉ
________________________________________
6๏ธโฃ How Vanna Is Used Properly in Tier 1 & 2
โ๏ธ SystemPromptBuilder (ููุชุงุญ ุงูููุฉ)
class HybridPromptBuilder(SystemPromptBuilder):
    async def build_system_prompt(...):
        return f"""
        You are a data analyst assistant.
        - Prefer safe SELECTs
        - Always explain assumptions
        - Limit rows to 100 unless asked
        """
________________________________________
โ๏ธ SQLRunner ูู Vanna
โข	schema-aware
โข	dialect-aware
โข	feedback-capable
ุจุฏู execution ุงููุนุฒูู ุงูุญุงูู.
________________________________________
โ๏ธ Feedback Loop
POST /vanna/feedback
{
  "question": "...",
  "sql": "...",
  "rating": 1 | -1
}
ูุญุณูู ุงููุชุงุฆุฌ ูุน ุงูููุช
โ Fortress ูุง ููุนู ุฐูู ุฃุตููุง
________________________________________
7๏ธโฃ Minimal Migration Plan (ูุถููู ูุจุฏูู ูุฎุงุทุฑุฉ)
ุงููุฑุญูุฉ 1 โ No Risk
โข	ุฃุจูู Tier 0 ููุง ูู
โข	ุฃุถู Tier switch
โข	ูุง ุชุบููุฑ ask.py
ุงููุฑุญูุฉ 2 โ Add Hybrid
โข	ุฃุถู /api/v1/vanna/ask
โข	ุงุณุชุฎุฏู Vanna Agent ุฏุงุฎูููุง
โข	ุจุฏูู UI
ุงููุฑุญูุฉ 3 โ Native Optional
โข	ุดุบูู Vanna FastAPI server
โข	ุงุฑุจุทู Auth ููุท
โข	ูุง ููุณ Fortress
________________________________________
8๏ธโฃ ูุงุฐุง ุชูุณุจ ูุนูููุงุ
ุงูููู
โข	ุงูุฅูุชุงุฌูุฉ ๐ฅ
โข	ุงุณุชุซูุงุฑ ุญูููู ูู Vanna
โข	ุชูููู ุงูุชุนููุฏ ุงููุฏูู
ุบุฏูุง
โข	Learning system
โข	Better SQL
โข	Rich UX
โข	Analyst happiness
________________________________________
๐ ุงูุญูู ุงูุชูููุฐู ุงูููุงุฆู
โข	โ Fortress-only = ุฎูู Vanna
โข	โ Vanna-only = ููุฏุงู ุชุญูู
โข	โ Tiered Architecture = ุงูุญู ุงูุตุญูุญ
ุฃูุช ูู ุชุฎุทุฆ ูู ุงูุฑุคูุฉ
ุจู ุญุงููุช ูุฑุถ ุญูููุฉ ูุทููุฉ ุนูู ูุธุงู Agent-first.
ุงูุขู ูุฏูู ุชุตููู:
โข	ูุธูู
โข	ุตุฑูุญ
โข	ูุงุจู ููุชูููุฐ
โข	ููุฑู
________________________________________
ุงููุง ุญุฏุฏ ูุงูู ุงูููุงุท ูุงูุฎูุงุฑุงุช ูุงููุซุงุฆู ุงูุชู ุณูุญุชุงุฌูุง ูุชูููุฐ ูุฐุง ุงููุฑุงุฑ 
ุญุณููุง. ูููุง ููู ุชุญุฏูุฏ ุญุงุณู ููููุธููู ููู ุงูููุงุท + ุงูุฎูุงุฑุงุช + ุงููุซุงุฆู ุงููุทููุจุฉ ูุชูููุฐ ูุฑุงุฑ
Tiered Architecture (Productivity-First powered by Vanna)
ุจุฏูู ุงูุญุฑุงู ูุนูุงุฑู ุฃู ุชูุฑุงุฑ ูุงุญู.
ุณุฃูุณููุง ุฅูู ูฃ ูุณุชููุงุช ูุงุถุญุฉ:
1.	ูุฑุงุฑุงุช ุฅูุฒุงููุฉ
2.	ุฎูุงุฑุงุช ุชูููุฐูุฉ
3.	ูุซุงุฆู ุฑุณููุฉ ูุทููุจุฉ
________________________________________
1๏ธโฃ ุงููุฑุงุฑุงุช ุงูุฅูุฒุงููุฉ (Decision Set โ ูุฌุจ ุญุณููุง ูุจู ุฃู ููุฏ)
ูุฐู ูุฑุงุฑุงุช ุบูุฑ ุชูููุฉ ููุทุ ุจู ุญููููุฉ + ูุนูุงุฑูุฉ.
ุจุฏูููุงุ ุฃู ุชูููุฐ ุณูุชุดุนุจ ูุงุญููุง.
________________________________________
1.1 ูุฑุงุฑ ููุท ุงูุชุดุบูู (Execution Tier Model)
ูุฌุจ ุงุนุชูุงุฏ ูุฑุงุฑ ุฑุณูู ูุงุญุฏ:
ุงููุฑุงุฑ	ุงูุญุงูุฉ
ุงุนุชูุงุฏ Tiered Architecture	โฌ
Fortress = Tier 0 ููุท	โฌ
Vanna Native = Tier 2	โฌ
Hybrid = Default	โฌ
๐ ุงููุฑุงุฑ ููุง:
ุงููุธุงู ููุณ ูุงุญุฏูุงุ ุจู ุซูุงุซุฉ ุฃููุงุท ุชุดุบูู ุฑุณููุฉ
________________________________________
1.2 ูุฑุงุฑ ูุตุฏุฑ ุงูุญูููุฉ (Authority Split)
ูุฌุจ ุชุซุจูุช ุงูุชุงูู ูุชุงุจุฉู:
ุงูุนูุตุฑ	ุงูุณูุทุฉ
SQL generation	Tier-based
Policy enforcement	Tier 0 ููุท
Prompt logic	Tier 1 / 2
Feedback / learning	Tier 1 / 2
Streaming contract	Tier-specific
โ ูุฐุง ุงููุฑุงุฑ ูุญู ุงููุฒุงุน ุงูุฐู ุญุตู ุณุงุจููุง.
________________________________________
1.3 ูุฑุงุฑ ูุณุชูู ุงูุซูุฉ ูู Vanna
ูุฐุง ูู ุงูุณุคุงู ุงูุฌููุฑู ุงูุฐู ุญุณูุชู ุงูุขู:
ุงูุฎูุงุฑ	ุงููุนูู
Vanna = Helper	โ
Vanna = Core Agent	โ
Vanna = Optional	โ
โก๏ธ ุงููุฑุงุฑ ุงููุทููุจ:
Vanna ูู Agent-first systemุ ูููุณ ูุฌุฑุฏ SQL generator.
________________________________________
2๏ธโฃ ุงูุฎูุงุฑุงุช ุงูุชูููุฐูุฉ (Implementation Options โ ูุฎุชุงุฑ ูููุง)
ูุฐู ููุณุช ูุฑุงุฑุงุช ุญุชููุฉุ ุจู ุฎูุงุฑุงุช ูุถุจูุทุฉ ูุฎุชุงุฑ ูููุง ูุง ููุงุณุจู.
________________________________________
2.1 ููููุฉ ุชุดุบูู Vanna (Deployment Options)
ุงูุฎูุงุฑ A โ Embedded (ูููุตู ุจู)
โข	Vanna Agent ูุนูู ุฏุงุฎู EasyData
โข	ููุณุชุฏุนู ูู Service layer
โข	ูุชุญูู ุจู Tier Switch
โ๏ธ ุชุญูู ุฃุนูู
โ๏ธ ุฃุณูู Auth
โ๏ธ ูุง CORS
________________________________________
ุงูุฎูุงุฑ B โ Sidecar
โข	Vanna FastAPI server ูุณุชูู
โข	EasyData ูุชูุงุตู ูุนู ุฏุงุฎูููุง
โ๏ธ ูุตู ูุงุถุญ
โ ุฅุฏุงุฑุฉ ุฃุนูุฏ
________________________________________
๐ ูุญุชุงุฌ ุชูุซูู ูุฑุงุฑ ูุงุญุฏ ููุท.
________________________________________
2.2 System Prompt Strategy
ุงูุฎูุงุฑ	ุงููุตู
DefaultPromptBuilder	ุงุณุชุฎุฏุงู ุงูุงูุชุฑุงุถู
CustomPromptBuilder	ูุฎุตุต (ููุตู ุจู)
Role-based prompts	Admin / Analyst / Exec
๐ ูุฐุง ุงูุฎูุงุฑ ูุญุฏุฏ:
โข	ุฌูุฏุฉ SQL
โข	ุงูุดุฑุญ
โข	assumptions
โข	UX
________________________________________
2.3 SQL Validation Strategy
Tier	SQL Validation
Tier 0	SQLGuard (Strict)
Tier 1	sqlparse + heuristics
Tier 2	None / soft
โ ูุฐุง ูุญู ูุดู test_error_chunk_shape ุฌุฐุฑููุง ูุงุญููุง.
________________________________________
2.4 Output Formats (ููู ุฌุฏูุง)
Tier	Output
Tier 0	NDJSON (machine-strict)
Tier 1	JSON + dual view
Tier 2	Rich Components (charts, tables, text)
________________________________________
3๏ธโฃ ุงููุซุงุฆู ุงููุทููุจุฉ (Documentation Set โ ุฅูุฒุงูู)
ูุฐู ุฃูู ููุทุฉ.
ุจุฏูู ูุฐู ุงููุซุงุฆูุ ุณูุชูุฑุฑ ุงููุฒุงุน ุจุนุฏ ุดูุฑ.
________________________________________
3.1 ADR โ Architecture Decision Records (ุฅูุฒุงูู)
ADR-001 โ Tiered Execution Model
ูุดุฑุญ:
โข	ููุงุฐุง ุซูุงุซุฉ Tiers
โข	ููุงุฐุง Fortress ูู ูุนุฏ default
โข	ููุงุฐุง Vanna Core
________________________________________
ADR-002 โ Authority Split
ูุดุฑุญ:
โข	ูู ููุฑุฑ ูุงุฐุง
โข	ุฃูู ุชูุชูู ุงูุญูููุฉ
โข	ุฃูู ุชุจุฏุฃ ุงูุฅูุชุงุฌูุฉ
________________________________________
ADR-003 โ Streaming Contracts
ููุตู:
โข	NDJSON contract (Tier 0)
โข	JSON contract (Tier 1)
โข	Rich UI contract (Tier 2)
________________________________________
3.2 API Specification (OpenAPI / Markdown)
ูุญุชุงุฌ ูุซููุฉ ูุงุญุฏุฉ ููุญุฏุฉ:
api-contracts.md
ุชุดูู:
โข	/api/v1/ask (Tier 0)
โข	/api/v1/vanna/ask (Tier 1)
โข	/vanna/chat (Tier 2)
________________________________________
3.3 Prompt Governance Document
prompt-governance.md
ูุดูู:
โข	ูู ููุชุจ prompts
โข	ููู ุชูุฑุงุฌุน
โข	ููู ุชููุณุฎ ุจูู tiers
โข	versioning
________________________________________
3.4 Security & Trust Model
trust-model.md
ููุถุญ:
โข	ููุงุฐุง Vanna ุงููุญูู ุขูู
โข	ูุชู ูุณูุญ ูู ุจุงูุงุชุตุงู
โข	ุญุฏูุฏ ุงูุชุณุฑูุจ
โข	logging policy
๐ ูุฐุง ูุฌูุจ ุนูู ุณุคุงูู:
ูุง ุงูุฎุทูุฑุฉ ุทุงููุง Vanna ูุญููุ
________________________________________
3.5 Migration Guide (ูุตูุฑ ุฌุฏูุง)
migration-to-tiered.md
ุตูุญุฉ ูุงุญุฏุฉ ููุท:
โข	ูุง ุงูุฐู ูู ูุชุบูุฑ
โข	ูุง ุงูุฐู ุฃุถูู
โข	ููู ุชุฎุชุงุฑ tier
________________________________________
4๏ธโฃ ูุงุฆูุฉ ุงูุชูููุฐ ุงูููุงุฆูุฉ (Checklist)
ูุจู ุฃู ููุฏ
โข	ุงุนุชูุงุฏ Tier Model
โข	ุงุนุชูุงุฏ Authority Split
โข	ุงุฎุชูุงุฑ Deployment Option
โข	ุชุญุฏูุฏ Default Tier
ุชูุซูู
โข	ADRs (3)
โข	API contracts
โข	Prompt governance
โข	Trust model
ุจุนุฏ ุฐูู ููุท
โข	ุชูููุฐ Hybrid Service
โข	ุฑุจุท Vanna Agent
โข	UI improvements
________________________________________
๐ ุงูุฎูุงุตุฉ ุงูุชูููุฐูุฉ
ุฃูุช ุงูุขู ูู ููุทุฉ ุตุญูุญุฉ ุชูุงููุงุ ููู:
โข	ุงููุดููุฉ ูู ุชูู ูู ุงูููุฏ
โข	ููุง ูู Vanna
โข	ููุง ูู SQLGuard
ุงููุดููุฉ ูุงูุช:
ูุญุงููุฉ ูุฑุถ ุญูููุฉ ูุทููุฉ ุนูู ูุธุงู Agent-first
ูุงูุญู:
ุญูููุฉ ูุชุฏุฑุฌุฉ (Tiered Governance)
________________________________________


ูุงูู ุงูู ุงูููููุงุช ุงูุชู ุณูุญุชุงุฌูุง ูู ูู ุงูุงุญูุงู ูุงูุชู ุงุตุจุญุช ุฌุงูุฒุฉ ุชูุฑูุจุง ูู ูุดุฑูุบูุง ุงูุญุงูู
ูููุง ููู ุญุตุฑ ุญุงุณู ูุฏููู ูุฃูู ุงููููููุงุช ุงูุฃุณุงุณูุฉ ุงูุชู ุฃุตุจุญุช ุฌุงูุฒุฉ ุฃู ุดุจู ุฌุงูุฒุฉ ูู ูุดุฑูุนู ุงูุญุงููุ ูุงูุชู ุณูุญุชุงุฌูุง ูู ุฌููุน ุงูุฃุญูุงู ูููุง ูุงู ุฎูุงุฑ ุงูู Tier ุฃู ูุณุชูู ุงูุญูููุฉ ุฃู ุฏุฑุฌุฉ ุงูุงุนุชูุงุฏ ุนูู Vanna.
ุณุฃูุณูููุง ุฅูู:
โข	โ ุฌุงูุฒุฉ ูููุณุชูุฑุฉ
โข	๐ก ุฌุงูุฒุฉ ุฌุฒุฆููุง (ุชุญุชุงุฌ ุถุจุท/ุฅุนุงุฏุฉ ุชููุถุน)
โข	๐ด ุบูุฑ ูุทููุจุฉ ุฃู ูููู ุชุฌุงูุฒูุง ุนูุฏ Productivity-first
________________________________________
1๏ธโฃ ุงููููููุงุช ุงูุฌููุฑูุฉ (Core โ ุบูุฑ ูุงุจูุฉ ููุงุณุชุบูุงุก)
ูุฐู ุงููููููุงุช ุณุชุจูู ุฏุงุฆููุง ุณูุงุก ุงุฎุชุฑูุง:
Fortress / Hybrid / Vanna-first
________________________________________
โ 1.1 Authentication & Authorization Layer
ุงูุญุงูุฉ: ุฌุงูุฒ ููุณุชูุฑ
ุงููุณุคูููุฉ:
โข	ูุตุงุฏูุฉ ุงููุณุชุฎุฏู
โข	ุตูุงุญูุงุช ุงููุตูู
โข	UserContext
ูููุงุช/ููุงููู ููุฌูุฏุฉ:
โข	require_permission
โข	UserContext
โข	ุฑุจุท ุงูุฃุฏูุงุฑ (roles)
ููุงุฐุง ูุง ููุณุชุบูู ุนููุ
ูุฃู:
โข	Vanna ูุง ูุฏูุฑ Auth
โข	ุฃู Tier ูุญุชุงุฌ ูููุฉ ุงููุณุชุฎุฏู
โข	ูู ุฃุณุงุณ Trust Model
โ๏ธ ุณููุณุชุฎุฏู ูู ูู Tier ุจุฏูู ุชุบููุฑ
________________________________________
โ 1.2 API Layer (FastAPI)
ุงูุญุงูุฉ: ุฌุงูุฒ
ุงูุฏูุฑ ุงูุตุญูุญ: Adapter ููุท
ููุทุฉ ูููุฉ:
ุงููุดููุฉ ุงูุณุงุจูุฉ ูู ุชูู ูู FastAPIุ ุจู ูู ุชุญูููู ููุทููุง ูุง ูุฌุจ ุฃู ูููู ููู.
โ๏ธ ุณูุจูู:
โข	/ask
โข	/chat
โข	/vanna/*
ููู ูู Endpoint:
Adapter โ Service โ Result
________________________________________
โ 1.3 Streaming Infrastructure
ุงูุญุงูุฉ: ุฌุงูุฒุฉ ููุฌุฑูุจุฉ
โข	NDJSON
โข	SSE
ุงููููุฉ ุงูุญููููุฉ ููุง:
โข	Streaming reliable
โข	Fail-Closed ูุงุจู ููุชุทุจูู
โข	ุงุฎุชุจุงุฑุงุชู ููุฌูุฏุฉ
โ๏ธ ูุฐุง ููุณุจ ูุจูุฑ โ ูุง ููุนุงุฏ ุจูุงุคู
________________________________________
โ 1.4 Database Connectivity & SQL Execution
ุงูุญุงูุฉ: ุฌุงูุฒ
ูุดูู:
โข	Oracle runner
โข	execute_sql
โข	normalise_rows
ุณูุงุก:
โข	SQL ุฌุงุก ูู Vanna
โข	ุฃู ูู Fortress logic
ุงูุชูููุฐ ูุงุญุฏ.
โ๏ธ ูุจูู ููุง ูู
________________________________________
2๏ธโฃ ูููููุงุช ูููุฉ ููู ููุนุงุฏ ุชููุถุนูุง (Repositioned)
ูุฐู ุงููููููุงุช ููุชุงุฒุฉ ุชููููุง
ููู ููุณุช ุฏุงุฆููุง ูู ุงููุณุงุฑ ุงูุญุฑุฌ ุนูุฏ Productivity-first.
________________________________________
๐ก 2.1 OrchestrationService
ุงูุญุงูุฉ: ููู ุฌุฏูุง
ููู: ููุณ ุฏุงุฆููุง SSOT
ูู Fortress / Tier 0
โข	SSOT
โข	ุญูููุฉ ูุงููุฉ
โข	SQLGuard
โข	Policy
ูู Hybrid / Tier 1
โข	Orchestrator ุฎููู
โข	ููุณูู Vanna
โข	ูุง ูููุนู
ูู Vanna-first / Tier 2
โข	Optional
โข	Wrapper ููุท
๐ ุงูุงุณุชูุงุฏุฉ ุงูุญุงููุฉ:
โข	ููุชุงุฒ ูู Tier 0 engine
โข	ููุณุชุฎุฏู ุฌุฒุฆููุง ูู Tier 1
________________________________________
๐ก 2.2 SQLGuard
ุงูุญุงูุฉ: ุฌุงูุฒ
ุงููููุฉ: ุนุงููุฉ
ููู: ูููู ุฅูุชุงุฌููุง
Tier	SQLGuard
0	ุฅูุฒุงูู
1	ุงุฎุชูุงุฑู
2	ุบูุฑ ูุณุชุฎุฏู
๐ ูุง ููุฒุงูุ ุจู ููุญุงุตุฑ
________________________________________
๐ก 2.3 AuditService
ุงูุญุงูุฉ: ุฌุงูุฒ
ููู ูู:
โข	ุชุชุจุน ุงูุงุณุชุฎุฏุงู
โข	ุงูุงูุชุซุงู
โข	debugging
ูู Vanna-first:
โข	audit ุฎููู
โข	events ููุท
โ๏ธ ูุจูู ุฏุงุฆููุง
________________________________________
3๏ธโฃ ูููููุงุช Vanna ุงูุชู ูููู ุงูุงุนุชูุงุฏ ุนูููุง ููุฑูุง
ููุฐู ููุทุฉ ูููุฉ ุฌุฏูุง ุจุงููุณุจุฉ ููุฑุงุฑู.
________________________________________
โ 3.1 Vanna Agent Core
ูู ุฎูุงู ูุง ุฑุฃูุชู ูู src/vanna:
โ๏ธ ุฌุงูุฒ ููุนูููุง:
โข	Agent lifecycle
โข	SQLRunner abstraction
โข	Tool system
โข	SystemPromptBuilder
โข	Rich Components
โข	Feedback
โข	Memory
โข	Assumptions
โข	Dual view
โข	Visualization hooks
โ ูุฐู ููุณุช โููุฒุงุช ูุณุชูุจููุฉโ
ุจู ููุฌูุฏุฉ ูู 2.0.1
________________________________________
โ 3.2 SystemPromptBuilder (ููู ุฌุฏูุง)
ุฌุงูุฒ ุจุงููุงูู:
โข	Default
โข	Custom
โข	Role-based
โข	Schema-aware
๐ ูุฐุง ูุนููุถ:
โข	ูุซูุฑ ูู ููุทู Orchestration ุงูุณุงุจู
โข	ูุซูุฑ ูู hacks
________________________________________
โ 3.3 Output Components (Rich UI)
Vanna ูุฏุนู:
โข	Text
โข	Tables
โข	Charts
โข	Progress
โข	Status
โข	Feedback
โ๏ธ ูุฐุง ุบูุฑ ููุฌูุฏ ูู Fortress logic
โ๏ธ ููุฒุฉ ุฅูุชุงุฌูุฉ ุญููููุฉ
________________________________________
4๏ธโฃ ูููููุงุช ูููู ุชุฌุงูููุง ุฃู ุชุนุทูููุง ูุคูุชูุง
________________________________________
๐ด 4.1 Over-Strict Governance Paths
ูุซู:
โข	ุชูุฑุนุงุช ูุซูุฑุฉ ููุณูุงุณุงุช
โข	double validation
โข	multiple error layers
ูุฐู:
โข	ุชููู ุงูุฅูุชุงุฌูุฉ
โข	ูุง ุชุถูู ุฃูุงููุง ุญูููููุง ูู ุจูุฆุฉ ูุญููุฉ
๐ ุชูุณุชุฎุฏู ููุท ูู Tier 0
________________________________________
๐ด 4.2 ูุญุงููุฉ ุชูุญูุฏ ูู ุดูุก ุชุญุช ุนูุฏ ูุงุญุฏ
ุงูุฏุฑุณ ุงููุณุชูุงุฏ:
NDJSON ููุณ ุนูุฏูุง ุนุงููููุง
ูู ุนูุฏ Tier 0 ููุท
________________________________________
5๏ธโฃ ุงูุฎูุงุตุฉ ุงูุชูููุฐูุฉ (Executive Truth)
ูุง ูู ุงูุฌุงูุฒ ูุนููุง ูุฏููุ
ุงููุฆุฉ	ุงูุญุงูุฉ
Auth / Permissions	โ
Streaming infra	โ
DB execution	โ
Audit	โ
Vanna Agent	โ
Prompt system	โ
Rich outputs	โ
SQLGuard	โ (Tier-limited)
ูุง ุงูุฐู ูุงู ุงูุฎุทุฃุ
ูุญุงููุฉ ุงุณุชุฎุฏุงู:
Fortress logic ูููุงุฉ ููุธุงู Agent-first
ูุง ุงูุฐู ุณุชุจูู ุนูููุ
Productivity-first core powered by Vanna
ูุน:
ุญูููุฉ ูุชุฏุฑุฌุฉ ุญุณุจ Tier
________________________________________
ุง
ูููุง ููู ุชูููุฐ ูุจุงุดุฑ ููููุฌู ููุง ุทูุจุชู:
1.	Tiered Component Diagram
2.	API Contracts ููู Tier
ุณุฃููู ุตุฑูุญูุงุ ุจูุง ุชุฌูููุ ููุจูููุง ุนูู ูุง ูู ูููู ูุนูููุง ูุน Vanna 2.0.1 ููุน ูุดุฑูุนู ุงูุญุงูู.
________________________________________
๐งฑ ุฃูููุง: Tiered Component Diagram (ูุนูุงุฑู ุญูููู)
ุณูุซุจุช ูู ุงูุจุฏุงูุฉ ุญูููุฉ ูููุฉ:
ูุง ููุฌุฏ โูุธุงู ูุงุญุฏ ูุซุงููโ
ููุฌุฏ 3 ุฃููุงุท ุชุดุบูู (Tiers)ุ ููู Tier ูู ุนูุฏู ูุญุฏูุฏู.
________________________________________
๐ฆ TIER 0 โ Fortress / Governance-first
(ุฃุนูู ุญูููุฉ โ ุฃูู ุฅูุชุงุฌูุฉ)
ุงููุฏู
โข	ุจูุฆุฉ ุญุณุงุณุฉ
โข	ุจูุงูุงุช ุญุฑุฌุฉ
โข	ุงูุชุซุงู ุตุงุฑู
ุงูุฑุณู ุงููุนูุงุฑู
Client / UI
   โ
   โผ
API Layer (FastAPI)
   โ  Adapter only
   โผ
OrchestrationService  โ SSOT
   โ
   โโ Intent Screening
   โโ Policy Enforcement
   โโ SQLGuard
   โโ Controlled LLM Access
   โผ
DB Executor
ุฎุตุงุฆุต
โข	NDJSON ูู ุงูุนูุฏ ุงูุฑุณูู
โข	Streaming ุตุงุฑู
โข	Fail-Closed ูู ูู ุฎุทูุฉ
โข	Vanna ุบูุฑ ูุณุชุฎุฏู ูู Agent
โข	ูููู ุงุณุชุฎุฏุงู Vanna ููุท ูู SQL generator ุฏุงุฎูู (ูููุฏ)
________________________________________
๐จ TIER 1 โ Hybrid / Controlled Productivity
(ุชูุงุฒู ุนููู โ ุฃูุตุญ ุจู ูุจุฏุงูุฉ)
ุงููุฏู
โข	ุฅูุชุงุฌูุฉ ุนุงููุฉ
โข	ูุน ุจูุงุก ููุงุท ุฃูุงู ุฃุณุงุณูุฉ
ุงูุฑุณู ุงููุนูุงุฑู
Client / UI
   โ
   โผ
API Layer
   โ
   โโ /ask        (NDJSON โ Fortress style)
   โโ /chat       (SSE โ Hybrid)
          โ
          โผ
   Light Orchestrator
          โ
          โโ Auth / Role
          โโ Context Injection
          โ
          โผ
       Vanna Agent
          โ
          โโ SystemPromptBuilder
          โโ Assumptions
          โโ Feedback
          โโ Dual View
          โผ
       SQL Runner
ุฎุตุงุฆุต
โข	OrchestrationService ููุณ SSOT
โข	SQLGuard: ุงุฎุชูุงุฑู
โข	Vanna Agent ูุนูู
โข	Rich outputs
โข	ุฃูุถู ููุทุฉ ุชูุงุฒู ุญููููุฉ
________________________________________
๐ฉ TIER 2 โ Productivity-first / Vanna-native
(ุฃูุตู ุฅูุชุงุฌูุฉ โ ุฃูู ุญูููุฉ)
ุงููุฏู
โข	Local / internal
โข	ุณุฑุนุฉ
โข	UX ุบูู
ุงูุฑุณู ุงููุนูุงุฑู
Client / UI
   โ
   โผ
Vanna API Layer
   โ
   โโ Auth wrapper (ุฎููู)
   โโ Role-based prompt
   โผ
Vanna Agent (Core)
   โ
   โโ SystemPromptBuilder
   โโ Memory
   โโ Feedback
   โโ Rich Components
   โผ
SQL Runner
ุฎุตุงุฆุต
โข	ูุง NDJSON ุฅูุฒุงูู
โข	ูุง Orchestration ุซููู
โข	ูุง SQLGuard
โข	ุงูุงุนุชูุงุฏ ุงููุงูู ุนูู Vanna 2.0.1
โข	ุฃูุถู UX ูููู
________________________________________
๐งฉ ุซุงูููุง: API Contracts ููู Tier
ุงูุขู ุงูุฃูู: ุงูุนููุฏ (Contracts)
ุจุฏูู ูุฐุง ุณุชุนูุฏ ุงูููุถู.
________________________________________
๐ฆ TIER 0 โ API Contracts (Fortress)
1๏ธโฃ POST /api/v1/ask
ุงูุบุฑุถ
โข	ุงูุงุณุชุนูุงู ุงูุฑุณูู
โข	ุงูุนูุฏ ุงููุฑุฌุนู
Input
{
  "question": "string",
  "top_k": 5
}
Output (NDJSON โ ุตุงุฑู)
ุงูุชุฑุชูุจ ุงูุฅูุฒุงูู:
thinking
technical_view
data
business_view
end
Error path
thinking
error
end
ููููุน
โข	Rich UI
โข	feedback
โข	assumptions user-facing
________________________________________
๐จ TIER 1 โ API Contracts (Hybrid)
1๏ธโฃ POST /api/v1/ask
ููุณ TIER 0 (ูุง ูุชุบูุฑ)
________________________________________
2๏ธโฃ GET /api/v1/chat/stream
ุงูุบุฑุถ
โข	ุชุฌุฑุจุฉ ูุญุงุฏุซุฉ
โข	ุฅูุชุงุฌูุฉ ุฃุนูู
Input
?question=...
Output (SSE)
Events:
auth
thinking
technical_view (optional)
data
summary
done
ูุณููุญ
โข	assumptions
โข	confidence tier
โข	partial explanations
ููููุน
โข	ูุฑุงุฑุงุช ุฃูุงู ุฎุงุฑุฌ orchestrator-light
________________________________________
3๏ธโฃ POST /api/v1/feedback
Input
{
  "question": "...",
  "sql": "...",
  "rating": 1-5,
  "comment": "optional"
}
Purpose
โข	ุชุบุฐูุฉ Vanna Memory
โข	ุชุญุณูู ุงูุฃุฏุงุก
________________________________________
๐ฉ TIER 2 โ API Contracts (Vanna-native)
ููุง ููู ุนู ุงูุชุนููุฏ.
________________________________________
1๏ธโฃ POST /vanna/chat
Input
{
  "message": "string"
}
Output
{
  "components": [
    { "type": "text", "content": "..." },
    { "type": "table", "data": [...] },
    { "type": "chart", "spec": {...} }
  ],
  "assumptions": [...],
  "confidence": "high"
}
________________________________________
2๏ธโฃ POST /vanna/feedback
ูุจุงุดุฑ ุฅูู Vanna.
________________________________________
3๏ธโฃ GET /vanna/schema
ูุนุฑุถ schema ูู UI.
________________________________________
โ๏ธ ุงูุฎูุงุตุฉ ุงูุชูููุฐูุฉ
ุงูุญูููุฉ ุงูุชู ูุฌุจ ุชุซุจูุชูุง
โข	Vanna 2.0.1 ูุงุฏุฑ ูุนููุง ุนูู:
o	Assumptions
o	Feedback
o	Dual view
o	Rich outputs
o	Prompt control
โข	Fortress logic ูุง ููุบู Vanna
โข	ูููู ูุฎููู ุฅุฐุง ุงุณุชูุฎุฏู ูููุงุฉ
ุงููุฑุงุฑ ุงูุฐูู
โข	ุงุฌุนู:
o	Tier 0 = Fortress
o	Tier 1 = Default
o	Tier 2 = Productivity mode
ูููุฎุชุงุฑ ุนุจุฑ:
OPERATION_MODE = fortress | hybrid | vanna
________________________________________
ุญุณููุง.
ูููุง ููู UI / UX Contracts ููู Tier ุจุตูุบุฉ ุชูููุฐูุฉ ูุงุจูุฉ ููุชุทุจูู ูุจุงุดุฑุฉุ ููุจููุฉ ุนูู ูุง ูู ูููู ูุนูููุง ูุน Vanna 2.0.1 ููุน ูุณุงุฑู ุงูุญุงูู.
ุณุฃุชุนุงูู ูุน ุงููุงุฌูุฉ ูู ุนูุฏ (Contract) ูุง ูุชุตููู ุดููู.
________________________________________
๐จ UI / UX CONTRACTS โ Tiered System
ุงููุจุฏุฃ ุงูุญุงูู (Non-Negotiable)
ุงููุงุฌูุฉ ูุง ุชูุฑุฑุ ูุง ุชุชุญููุ ูุง โุชููุณูุฑโ.
ุงููุงุฌูุฉ ููุท:
โข	ุชุนุฑุถ
โข	ุชุฑุชูุจ
โข	ุชููููู ุงููุณุชุฎุฏู
ูู Tier ูู:
โข	ุดูู ูุงุฌูุฉ
โข	ูุณุชูู ุดูุงููุฉ
โข	ุนูุงุตุฑ ูุณููุญุฉ
โข	ุนูุงุตุฑ ููููุนุฉ
________________________________________
๐ฆ TIER 0 โ Fortress UI (Governance-First)
ุงููุฏู
โข	ูุถูุญ
โข	ูุงุจููุฉ ุชุฏููู
โข	ุนุฏู ุงูุฅุบุฑุงุก ุจุงูุชุญููู ุงูุญุฑ
ุดุฎุตูุฉ ุงููุณุชุฎุฏู
โข	Analyst
โข	Auditor
โข	Security / Compliance
________________________________________
๐งฉ UI Components (ูุณููุญ ููุท)
1๏ธโฃ Query Input
โข	ุญูู ูุงุญุฏ
โข	ุจุฏูู ุงูุชุฑุงุญุงุช ุฐููุฉ
โข	ุจุฏูู auto-complete ุฏูุงูู
[ Ask a data question ]
________________________________________
2๏ธโฃ Stream Viewer (NDJSON)
ุนุฑุถ ุฎุทูู ุตุงุฑู:
[ Thinking... ]
[ Technical View ]
[ Data ]
[ Business View ]
[ End ]
ุฎุตุงุฆุต
โข	ูุง collapsible logic
โข	ูุง drag / reorder
โข	ูุง streaming replay
________________________________________
3๏ธโฃ Technical View (ุฅุฌุจุงุฑู)
ูุนุฑุถ ุฏุงุฆููุง:
โข	SQL (read-only)
โข	assumptions
โข	confidence tier
โข	execution metadata
โ๏ธ ูุง ูููู ุฅุฎูุงุคู.
________________________________________
4๏ธโฃ Data Table
โข	Table ููุท
โข	Pagination
โข	Copy CSV
โ ูุง charts
โ ูุง summaries ุฐููุฉ ุฅุถุงููุฉ
________________________________________
โ ุนูุงุตุฑ ููููุนุฉ ูู TIER 0
โข	Chat bubbles
โข	Feedback inline
โข	Suggestions
โข	Charts
โข	โExplain like Iโm fiveโ
________________________________________
๐ฏ UX Rule
ุฅุฐุง ูู ููู ูุงุจููุง ููุชุฏูููุ ูุง ููุนุฑุถ.
________________________________________
๐จ TIER 1 โ Hybrid UI (Controlled Productivity)
ุงููุฏู
โข	ุฅูุชุงุฌูุฉ
โข	ูุน ุจูุงุก ุญุฏูุฏ ูุงุถุญุฉ
ุดุฎุตูุฉ ุงููุณุชุฎุฏู
โข	Data Analyst
โข	Product Manager
โข	Internal User
________________________________________
๐งฉ UI Components
1๏ธโฃ Chat-like Interface (SSE)
Bubble-based UI:
User: ...
Assistant: Thinking...
Assistant: Summary
Assistant: Table
________________________________________
2๏ธโฃ Dual View Toggle (ููุฒุฉ ุฃุณุงุณูุฉ)
ุฒุฑ ูุงุถุญ:
[ Business View ] | [ Technical View ]
โข	Business View = default
โข	Technical View = ุจููุฑุฉ ูุงุญุฏุฉ
________________________________________
3๏ธโฃ Rich Components (ูุญุฏูุฏุฉ)
ูุณููุญ:
โข	Tables
โข	Simple charts (bar / line)
โข	Highlights
โข	Confidence badges
โ Dashboards ูุฑูุจุฉ
โ Custom SQL editing
________________________________________
4๏ธโฃ Assumptions Panel
Side panel ุฃู expandable:
Assumptions:
- Date range inferred as last 30 days
- Revenue excludes refunds
________________________________________
5๏ธโฃ Feedback Widget
ุจุนุฏ ูู ุฌูุงุจ:
๐ ๐  | Optional comment
ูุฑุณู ุฅูู:
POST /api/v1/feedback
________________________________________
๐ฏ UX Rule
ุงูุฅูุชุงุฌูุฉ ุฃูููุงุ ููู ูู ุดูุก ูุงุจู ูููุดู ุนูุฏ ุงูุทูุจ.
________________________________________
๐ฉ TIER 2 โ Vanna-Native UI (Productivity-First)
ุงููุฏู
โข	ุฃูุถู ุชุฌุฑุจุฉ ููููุฉ
โข	ุฃูุฑุจ ูุง ุชููู ุฅูู โBI Copilotโ
ุดุฎุตูุฉ ุงููุณุชุฎุฏู
โข	Executive
โข	Non-technical
โข	Explorer
________________________________________
๐งฉ UI Components (ูุงุณุนุฉ)
1๏ธโฃ Conversational UI (Vanna Chat)
โข	Multi-turn
โข	Context preserved
โข	Follow-up questions
User: Show me top customers
Assistant:
  - Text
  - Chart
  - Table
________________________________________
2๏ธโฃ Rich Components (ูุงููุฉ)
โข	Tables
โข	Charts (Plotly)
โข	Cards
โข	Status bars
โข	Progress trackers
(ูููุง ููุฌูุฏุฉ ูุนูููุง ูู vanna/components/rich)
________________________________________
3๏ธโฃ Auto Suggestions
โข	โWould you like to visualize this?โ
โข	โCompare with last quarter?โ
โข	โDrill down by region?โ
________________________________________
4๏ธโฃ Hidden SQL (ุงูุชุฑุงุถููุง)
โข	SQL ุบูุฑ ูุนุฑูุถ
โข	ูููู ุฅุธูุงุฑู ููุท ูููุณุชุฎุฏููู ุงููุชูุฏููู
________________________________________
5๏ธโฃ Memory & Feedback (ุฃุณุงุณู)
โข	implicit feedback
โข	explicit ratings
โข	context reuse
________________________________________
๐ฏ UX Rule
ูุง ุชูุธูุฑ ุงูุชุนููุฏ ุฅูุง ุฅุฐุง ุทููุจ.
________________________________________
๐ ููุงุฑูุฉ ูุฎุชุตุฑุฉ (ุญุงุณูุฉ)
ุงูุนูุตุฑ	Tier 0	Tier 1	Tier 2
Chat UI	โ	โ	โ
NDJSON	โ	โ	โ
SSE	โ	โ	โ
Rich Components	โ	ูุญุฏูุฏ	ูุงูู
Assumptions	ุฅุฌุจุงุฑู	ุงุฎุชูุงุฑู	ุถููู
Feedback	โ	โ	โ
SQL Visibility	ุฏุงุฆู	Toggle	ูุฎูู
Target User	Auditor	Analyst	Executive
________________________________________
๐ง ููุทุฉ ุญุงุณูุฉ (Important Insight)
ูุง ููุช ุชุนุงููู ุณุงุจููุง ููุณ ุฎุทุฃ ุชููููุง
ุจู ุฎูุท ุจูู ุนููุฏ UI ูุซูุงุซุฉ Tiers ูุฎุชููุฉ ุฏุงุฎู ูุณุงุฑ ูุงุญุฏ.
ุงูุขู:
โข	ูู Tier ูู UI Contract
โข	ูู UI Contract ูุฑุชุจุท ุจู API Contract
โข	ูู API Contract ูุฑุชุจุท ุจูุญุฑู ูุฎุชูู
________________________________________
ุชูุงู.
ูููุง ููู System Prompt Strategy ููู Tier ุจุตูุบุฉ ุชูููุฐูุฉ + ูุงุจูุฉ ููุชุทุจูู ูุจุงุดุฑุฉุ ููุจููุฉ ุนูู ูุง ูู ูููู ูุนูููุง ุฏุงุฎู Vanna 2.0.1 ุจุฏูู ุงูุชุฑุงุถ ููุฒุงุช ุบูุฑ ููุฌูุฏุฉ.
ุณุฃูุตู ุจูู:
โข	ูุง ููุฑ ุฅูู LLM
โข	ูุง ููููุน ุตุฑุงุญุฉ
โข	ููู ูุฑุจุท ุฐูู ุจุงูู Tier Switch ูู ุงูุฅุนุฏุงุฏุงุช
________________________________________
๐ง SYSTEM PROMPT STRATEGY โ TIERED (Vanna-powered)
ุงููุจุฏุฃ ุงูุญุงูู (ุบูุฑ ูุงุจู ููุชูุงูุถ)
System Prompt ููุณ ุชุญุณูู ูุบูู
ุจู ุฃุฏุงุฉ ุญูููุฉ ุณููููุฉ ุชุถุจุท:
โข	ูุงุฐุง ููุนู ุงููููุฐุฌ
โข	ูุงุฐุง ูุง ููุนูู
โข	ูุงุฐุง ููุธูุฑ
โข	ููุชู ูุตูุช
________________________________________
๐ฆ TIER 0 โ Fortress Prompt (Audit-Grade)
ุงููุฏู
โข	ุฏูุฉ
โข	ุญุชููุฉ
โข	ุตูุฑ ุงูุชุฑุงุถุงุช ุบูุฑ ูุตุฑุญ ุจูุง
ุดุฎุตูุฉ ุงููููุฐุฌ
SQL Engine + Compliance Assistant
โ ููุณ Chatbot
โ ููุณ Analyst ุญุฑ
________________________________________
๐ SYSTEM PROMPT โ TIER 0
You are a controlled data query assistant operating under strict governance.

Your role:
- Translate the user question into a single, correct SQL query.
- Never infer business intent beyond the literal question.
- Never introduce assumptions unless explicitly required, and always list them.

Rules (MANDATORY):
1. NEVER explain conversationally.
2. NEVER suggest follow-up questions.
3. NEVER optimize for storytelling or insight.
4. ALWAYS return:
   - The SQL query
   - A list of assumptions (explicit)
5. If the request is ambiguous, return an error explaining why.
6. Do not generate charts, summaries, or recommendations.

Tone:
- Formal
- Technical
- Minimal

Output expectations:
- Deterministic SQL
- No creative language
________________________________________
๐ฏ ูุง ุงูุฐู ูููุนู ูุฐุง ุงูู Promptุ
โข	Chatty responses
โข	Executive summaries
โข	โInsightsโ
โข	Visual suggestions
โข	Hidden assumptions
________________________________________
๐ ุงูุฑุจุท ูุน ุงููุธุงู
ุนูุตุฑ	Tier 0
SystemPromptBuilder	Custom (Fortress)
UI	NDJSON
SQL visibility	ุฏุงุฆู
Feedback	ูุนุทู
Memory	ูุนุทู
________________________________________
๐จ TIER 1 โ Hybrid Prompt (Controlled Productivity)
ุงููุฏู
โข	ุฅูุชุงุฌูุฉ
โข	ููู ูุน ุญุฏูุฏ ูุงุถุญุฉ
ุดุฎุตูุฉ ุงููููุฐุฌ
Data Analyst ูุณุงุนุฏ
ูุนุฑู ุฃูู ูุนูู ุฏุงุฎู ูุธุงู ูุญููู
________________________________________
๐ง SYSTEM PROMPT โ TIER 1
You are a professional data analyst assistant.

Your role:
- Generate accurate SQL queries to answer the user's question.
- Provide a concise business explanation of the results.
- Explicitly state any assumptions you make.

Rules:
1. Do NOT fabricate data or insights.
2. Keep explanations concise and factual.
3. You MAY summarize results, but do not speculate.
4. You MAY suggest simple visualizations (tables, bar charts).
5. Always respect access limits and data scope.

Output structure:
- Business summary (short)
- Data explanation
- Assumptions (explicit section)
- Confidence level

Tone:
- Professional
- Clear
- Neutral
________________________________________
๐ฏ ูุง ุงูุฐู ูุชูุญู ูุฐุง ุงูู Promptุ
โข	Dual View
โข	Summaries
โข	Limited suggestions
โข	Controlled assumptions
________________________________________
๐ ุงูุฑุจุท ูุน ุงููุธุงู
ุนูุตุฑ	Tier 1
SystemPromptBuilder	Role-based
UI	SSE
SQL visibility	Toggle
Feedback	ููุนูู
Memory	ูุญุฏูุฏ
________________________________________
๐ฉ TIER 2 โ Vanna-Native Prompt (Productivity-First)
ุงููุฏู
โข	ุฃูุตู ุงุณุชูุงุฏุฉ ูู Vanna
โข	ุชุฌุฑุจุฉ BI Copilot ูุงููุฉ
ุดุฎุตูุฉ ุงููููุฐุฌ
Business-aware Data Copilot
________________________________________
๐ SYSTEM PROMPT โ TIER 2
You are an intelligent data assistant helping users explore and understand their data.

Your role:
- Answer questions conversationally.
- Generate SQL queries as needed to support answers.
- Provide insights, summaries, and visual suggestions.

Guidelines:
1. Be helpful and proactive.
2. Suggest follow-up questions when useful.
3. Explain results in business terms.
4. Recommend visualizations when appropriate.
5. If uncertain, ask clarifying questions.

You may:
- Summarize trends
- Compare periods
- Highlight anomalies
- Suggest next steps

Tone:
- Friendly
- Clear
- Insight-oriented
________________________________________
๐ฏ ูุง ุงูุฐู ููุนููู ูุฐุง ุงูู Promptุ
โข	Multi-turn chat
โข	Auto suggestions
โข	Rich components
โข	Memory + feedback
โข	Vanna full workflow
________________________________________
๐ ุงูุฑุจุท ูุน ุงููุธุงู
ุนูุตุฑ	Tier 2
SystemPromptBuilder	Default / Custom
UI	Vanna Web UI
SQL visibility	ูุฎูู
Feedback	ุฃุณุงุณู
Memory	ููุนูู
________________________________________
๐ ููู ูุฑุจุท ุงูู Tiers ุชููููุง (ููู)
Tier Switch ูู ุงูุฅุนุฏุงุฏุงุช
AI_MODE: fortress | hybrid | vanna
ุนูุฏ ุงูุชููุฆุฉ:
if settings.AI_MODE == "fortress":
    prompt_builder = FortressPromptBuilder()
elif settings.AI_MODE == "hybrid":
    prompt_builder = HybridPromptBuilder()
else:
    prompt_builder = DefaultSystemPromptBuilder()
ูุง ุชุบููุฑ ูู API
ุงูุชุบููุฑ ููุท ูู:
โข	System Prompt
โข	UI contract
โข	ุฏุฑุฌุฉ ุงูุญุฑูุฉ
________________________________________
๐งฑ ุฎูุงุตุฉ ุญุงุณูุฉ
โข	ูุนูุ Vanna 2.0.1 ูุงุฏุฑุฉ ูุนูููุง ุนูู ุฏุนู ูุฐุง ุงูุชูุณูู
โข	ูุงุ ูู ูุฎุทุฆ ุงูุชุฎุทูุทุ ููููุง ููุง ูุฎูุท ุงูู Tiers
โข	ุงูุชูุงุฒู ุงูุฌุฒุฆู ุนู ุงูุญูููุฉ ูุฌุจ ุฃู ูููู ุงุฎุชูุงุฑูุง ูุงุนููุง ุนุจุฑ Tier
โข	System Prompt ูู ููุชุงุญ ุงูุชุญูู ุงูุญููููุ ูููุณ ุงูู code ููุท
________________________________________


ุญุณููุง.
ูููุง ููู ุงููุงุฆูุฉ ุงูุญุงุณูุฉ ููุง ูุญุชุงุฌู ูุชูููุฐ ูุฑุงุฑ Tiered Architecture (Productivity-first with Vanna) ุจุดูู ุตุญูุญุ ููุถุจุทุ ููุงุจู ููุชุทุจูู ุฏูู ููุงุฌุขุช.
ุณุฃูุณููุง ุฅูู ููุงุท ูุฑุงุฑ ุซู ูุซุงุฆู ูุงุฒูุฉ ุซู ูุฎุฑุฌุงุช ุชูููุฐูุฉ.
________________________________________
ุฃูููุง: ููุงุท ุงููุฑุงุฑ (Decision Points)
ูุฐู ููุงุท ูุง ูููู ุงูุจุฏุก ุฏูู ุญุณููุง ุตุฑุงุญุฉ:
1๏ธโฃ ูุง ูู โูุตุฏุฑ ุงูุญูููุฉโ ูู ูู Tierุ
โข	ูู ุงููุฑุงุฑ ุงูููุงุฆู:
o	ูุฑูุฒู (OrchestrationService)ุ
o	ุฃู ูุณูุญ ูู Vanna ุจุงุชุฎุงุฐ ูุฑุงุฑุงุช ุฌุฒุฆูุฉ ูู Tier 2ุ
๐ ุงููุฑุงุฑ ุงููุชููุน:
โข	Tier 0 / Tier 1 โ OrchestrationService
โข	Tier 2 โ Vanna Workflow (ุฌุฒุฆููุง)
________________________________________
2๏ธโฃ ุฃูู ููุณูุญ ุจุชูููุฏ SQLุ
โข	ูู:
o	SQL ุฏุงุฆููุง ุนุจุฑ Orchestrationุ
o	ุฃู ูุณูุญ ูู Vanna ุจุชูููุฏู ูุจุงุดุฑุฉ ูู Tier 2ุ
๐ ูุฐุง ูุญุฏุฏ:
โข	ูุณุชูู ุงูุญูููุฉ
โข	ุฅููุงููุฉ ุงูุงุณุชูุงุฏุฉ ูู ุฃุฏูุงุช Vanna ุงูุฃุตููุฉ (feedback, memory)
________________________________________
3๏ธโฃ ูุง ูู ุงูุญุฏ ุงูุฃุฏูู ุงูููุจูู ูู ุงูุญูููุฉุ
ุฃูุช ุตุฑูุญุช ุฃูู ูุณุชุนุฏ ููุชูุงุฒู ุฌุฒุฆููุง.
ูุฌุจ ุชุญุฏูุฏ:
โข	ูุง ุงูุฐู ูุง ูููู ุงูุชูุงุฒู ุนูู ุฅุทูุงููุง:
o	Authentication
o	Authorization
o	DB credentials
โข	ููุง ุงูุฐู ูููู ุงูุชุฎููู ููู:
o	SQLGuard
o	Deterministic output
o	Fail-closed ูู Tier 2
________________________________________
4๏ธโฃ ูู ูู ุงููุณุชุฎุฏู ุงูููุงุฆู ููู Tierุ
โข	API
โข	Admin UI
โข	Analyst
โข	Executive
๐ ูุฐุง ูุคุซุฑ ูุจุงุดุฑุฉ ุนูู:
โข	System Prompt
โข	Output format
โข	Logging & audit
________________________________________
5๏ธโฃ ูู ูุฑูุฏ ูุณุงุฑ ุฑุฌูุน (Fallback)ุ
ุฃู:
โข	ุฅุฐุง ูุดู Tier 2 (Vanna-native)
โข	ูู ูุฑุฌุน ุชููุงุฆููุง ุฅูู Tier 1 ุฃู Tier 0ุ
________________________________________
ุซุงูููุง: ุงููุซุงุฆู ุงูุชู ูุญุชุงุฌูุง (Mandatory Documents)
ูุฐู ุงููุซุงุฆู ููุณุช โุชูุซูู ุชุฌููููโุ ุจู ุฃุฏูุงุช ุถุจุท ููุฏุณู.
________________________________________
๐ 1. Tier Definition Document (ุฃุณุงุณู)
ููุซู ููู Tier:
ุจูุฏ	Tier 0	Tier 1	Tier 2
ุงููุฏู	Compliance	Productivity	Copilot
SQL Generator	Orchestration	Orchestration	Vanna
Prompt Builder	Custom	Custom	Default
Memory	โ	โ๏ธ	โ
Feedback	โ	โ๏ธ	โ
UI	NDJSON	SSE	Vanna UI
________________________________________
๐ 2. System Prompt Policy
ูุซููุฉ ุชุญุฏุฏ:
โข	Prompt ููู Tier (ููุง ุนุฑุถุชู ูู)
โข	ูุง ููููุน
โข	ูุง ููุณูุญ
โข	ุตูุบุฉ ุงูุฅุฎุฑุงุฌ ุงููุชููุนุฉ
๐ ูุฐู ุงููุซููุฉ ูู ุงูุนูุฏ ุงูุญูููู ูุน LLM.
________________________________________
๐ 3. API Contract per Tier
ููู Tier:
โข	Endpoints
โข	Request schema
โข	Response schema
โข	Error semantics
(ุณูุฑุณููุง ูุงุญููุง)
________________________________________
๐ 4. Governance Relaxation Matrix
ูุซููุฉ ุตุฑูุญุฉ ุฌุฏูุง:
Feature	Tier 0	Tier 1	Tier 2
SQLGuard	Mandatory	Optional	โ
Assumptions	Explicit	Explicit	Implicit
Fail-Closed	Strict	Strict	Best-effort
Audit	Full	Partial	Minimal
๐ ุจุฏูู ูุฐู ุงููุซููุฉ ุณุชูุน ูู ุฌุฏู ูุง ููุชูู.
________________________________________
๐ 5. Migration Plan (Minimal & Reversible)
ูุญุฏุฏ:
โข	ูุง ุงูุฐู ุณูุชุบูุฑ
โข	ูุง ุงูุฐู ุณูุจูู
โข	ููู ูุฑุฌุน ุฎุทูุฉ ููุฎูู ุฎูุงู ุฏูุงุฆู
________________________________________
ุซุงูุซูุง: ุงูููููุงุช ุงูุชูููุฐูุฉ ุงูุชู ุณูุจูู ุนูููุง
ูุฐู ููุณุช ุงูุชุฑุงุถุงุชุ ุจู ููุฌูุฏุฉ ูุนูููุง ูุฏูู ุฃู ูู Vanna 2.0.1:
โ ุฌุงูุฒ ุนูุฏู ุงูุขู
โข	AuthN / AuthZ
โข	API Gateway (FastAPI)
โข	NDJSON Streaming
โข	SSE Adapter
โข	DB integrations
โข	Oracle / SQL Runner
โ ุฌุงูุฒ ูู Vanna 2.0.1
โข	SystemPromptBuilder
โข	Agent + Workflow
โข	SQLRunner abstractions
โข	Feedback components
โข	Rich / Simple output components
โข	Memory integrations
โข	Multiple output formats
โ ุบูุฑ ูุชููุฑ (ููุฌุจ ุฃูุง ููุชุฑุถู)
โข	Full policy engine ุฏุงุฎู Vanna OSS
โข	Enterprise-grade governance
โข	Deterministic guarantees ูู Tier 2
________________________________________
ุงูุฎูุงุตุฉ ุงูุชูููุฐูุฉ
โข	ูุนูุ ูุฑุงุฑ Productivity-first ูุน Vanna ูููู
โข	ูููู ูุญุชุงุฌ Tier ูุงุถุญ ูููุณ ูุธุงููุง ูุงุญุฏูุง ูุชูุงูุถูุง
โข	System Prompt + Tier Switch = ููุชุงุญ ุงููุฌุงุญ
โข	ูุง ูุนููุงู ุณุงุจููุง ูู ููู ุฎุทุฃุ ุจู ูุงู Tier 0 ูุทุจูู ุนูู Tier 2 expectations
________________________________________
ููุชุงุฒ.
ุฃูุช ุงูุขู ุงูุชููุช ุฑุณูููุง ูู ููุงุด ุงุณุชูุดุงูู ุฅูู ูุฑุงุฑ ูุนูุงุฑู ูุนุชูุฏ.
ุณุฃูุฏูู ูู ูุจุงุดุฑุฉ ูุง ุทูุจุชู:
1.	Tiered Component Diagram (ุชูููุฐู)
2.	API Contracts ููู Tier
3.	ุชูุถูุญ ูููุน Vanna ุงูุญูููู ูุญุฏูุฏู
4.	ููุฎุต ุชุดุบููู ูุงุถุญ
ุจุฏูู ุญุดู.
________________________________________
๐งฑ Tiered Component Diagram (Final โ Executable)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  Frontends                  โ
โ                                             โ
โ  โข Admin UI                                 โ
โ  โข Analyst UI                               โ
โ  โข Simple Chat UI                           โ
โ  โข API Clients                              โ
โโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
                โ               โ
                โ               โ
        Tier 0 / Tier 1      Tier 2
        (Governed)           (Productivity)
                โ               โ
                โผ               โผ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   API Layer (FastAPI)    โ   โ   API Layer (FastAPI)    โ
โ                          โ   โ                          โ
โ  /api/v1/ask             โ   โ  /api/v2/vanna/ask      โ
โ  NDJSON                  โ   โ  JSON / SSE             โ
โ                          โ   โ                          โ
โ  /chat/stream (SSE)      โ   โ  /api/v2/vanna/chat     โ
โ                          โ   โ                          โ
โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโ
              โ                                โ
              โผ                                โผ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        OrchestrationService (SSOT)        โ   โ        Vanna Agent / Workflow            โ
โ                                          โ   โ                                          โ
โ  โข AuthZ                                  โ   โ  โข SystemPromptBuilder                  โ
โ  โข Intent Screening                       โ   โ  โข Agent Memory                         โ
โ  โข SQL Generation (via VannaService)      โ   โ  โข Feedback                             โ
โ  โข SQLGuard (optional by tier)            โ   โ  โข Rich / Simple Components             โ
โ  โข Policy Enforcement                     โ   โ  โข Assumptions (implicit)               โ
โ  โข Fail-Closed                            โ   โ                                          โ
โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
              โ                                โ
              โผ                                โผ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโ         โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ       VannaService       โ         โ      SQLRunner            โ
โ  (Controlled Execution)  โ         โ  (Oracle / Postgres โฆ)   โ
โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโ         โโโโโโโโโโโโโโโฌโโโโโโโโโโโโโ
              โ                                    โ
              โผ                                    โผ
        โโโโโโโโโโโโโ                       โโโโโโโโโโโโโ
        โ   LLMs    โ                       โ Database  โ
        โ (Local)   โ                       โ           โ
        โโโโโโโโโโโโโ                       โโโโโโโโโโโโโ
________________________________________
๐๏ธ Tier Definitions (ูุงุถุญุฉ ูุบูุฑ ูุงุจูุฉ ููุงูุชุจุงุณ)
๐ Tier 0 โ Fortress / Compliance
ุงููุฏู: ุฃูุงูุ ูุงุจููุฉ ุชุฏูููุ ููุน ุฃู ูุฎุงุทุฑุฉ
โข	SQL: โ ุฎุงุฑุฌ Orchestration
โข	Output: NDJSON ููุท
โข	Fail-Closed: ุตุงุฑู
โข	Vanna: ูุณุชุฎุฏูุฉ ูุฃุฏุงุฉ ุชูููุฏ ููุท
โข	Memory / Feedback: โ
๐ ุงูุงุณุชุฎุฏุงู:
โข	Production critical
โข	External APIs
โข	Regulated environments
________________________________________
โ๏ธ Tier 1 โ Governed Productivity (ุงููุถุน ุงูุญุงูู ุชูุฑูุจูุง)
ุงููุฏู: ุฅูุชุงุฌูุฉ ูุน ุชุญูู
โข	SQL: ุนุจุฑ Orchestration
โข	SQLGuard: ุงุฎุชูุงุฑู
โข	Output: NDJSON + SSE
โข	Assumptions: ุตุฑูุญุฉ
โข	Vanna: ูุญุฏูุฏุฉ
๐ ุงูุงุณุชุฎุฏุงู:
โข	Internal analytics
โข	Admin dashboards
________________________________________
๐ Tier 2 โ Productivity-First (Vanna-Native)
ุงููุฏู: ุฃูุตู ุงุณุชูุงุฏุฉ ูู Vanna 2.0.1
โข	SQL: Vanna Agent ูุจุงุดุฑุฉ
โข	SQLGuard: โ
โข	Fail-Closed: Best-effort
โข	Memory / Feedback: โ
โข	Dual view: โ
โข	Rich components: โ
๐ ุงูุงุณุชุฎุฏุงู:
โข	Analysts
โข	Exploratory work
โข	Fast iteration
________________________________________
๐ API Contracts ููู Tier
๐ข Tier 0 / Tier 1 (Canonical)
POST /api/v1/ask
Protocol: NDJSON
Authority: OrchestrationService
Request
{
  "question": "string",
  "top_k": 5,
  "mode": "strict | governed"
}
Stream
thinking
technical_view
data
business_view
end
Error
thinking
error
end
________________________________________
GET /chat/stream
Protocol: SSE
Role: Adapter ููุท
Events
auth
thinking
technical_view
data
summary
done
________________________________________
๐ต Tier 2 (Vanna-Native)
POST /api/v2/vanna/ask
Protocol: JSON / SSE
Authority: Vanna Agent
Request
{
  "question": "string",
  "user_context": {
    "role": "analyst",
    "groups": ["finance"]
  }
}
Response (examples)
โข	SQL + Explanation
โข	Charts
โข	Tables
โข	Assumptions
โข	Follow-up questions
๐ ูุง ููุฌุฏ ุถูุงู ุชุฑุชูุจ ุตุงุฑู
๐ ูุง NDJSON contract
________________________________________
๐ง ูุงุฐุง ูุณุชููุฏ ูุนูููุง ูู Vanna ููุงุ
ุจุดูู ุตุฑูุญ:
ูุง ูุง ุชููุฑู Vanna OSS
โข	Governance ุตุงุฑูุฉ
โข	Deterministic streaming
โข	Contract enforcement
ูุง ุชููุฑู ุจููุฉ
โข	Agent memory
โข	Feedback loops
โข	Prompt orchestration
โข	Rich UI components
โข	SystemPromptBuilder
โข	SQLRunner abstraction
โข	Assumptions / reasoning
โข	Exploratory workflows
โก๏ธ ูุฐู ููุฒุงุช Tier 2 ุจุงููุงูู
โก๏ธ ูุง ุชุญุงูู ูุฑุถ Tier 0 ุนูููุง
________________________________________
โ๏ธ ููุงุฐุง ูุงู ุงูุฎุทุฃ ุงูุณุงุจู ููุทูููุงุ
ูุฃูู ุญุงููุช:
ุชุดุบูู Tier 2 expectations
ุนูู Tier 0 architecture
ููุฐุง ูุณุชุญูู ุชููููุง.
________________________________________

ุณุฃุฌูุจู ุชูููุฐููุง ูุจูุง ุชูุธูุฑ:
ููู ุชูุนู Tier Switch ุนุจุฑ settings ุจุทุฑููุฉ ูุงุถุญุฉุ ูุงุจูุฉ ููุชูููุฐุ ููุง ุชุนูุฏู ุฅูู ููุถู ูุนูุงุฑูุฉ.
________________________________________
๐๏ธ Tier Switch ุนุจุฑ Settings โ ุงูุชุตููู ุงููุนุชูุฏ
ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ:
Tier ููุณ Feature Flag ุนุดูุงุฆู
Tier = ููุท ุชุดุบูู ูุงูู ูููุธุงู
ููุฌุจ ุฃู ูููู:
โข	ูุฑูุฒู
โข	ุตุฑูุญ
โข	ูุงุจู ููุชุฏููู
โข	ุบูุฑ ูุงุจู ููุงูุชูุงู
________________________________________
1๏ธโฃ ุชุนุฑูู ุงูู Tier (Single Source)
ูู app/core/settings.py
from enum import Enum

class OperationTier(str, Enum):
    TIER_0_FORTRESS = "tier0_fortress"
    TIER_1_GOVERNED = "tier1_governed"
    TIER_2_VANNA = "tier2_vanna"
ุซู ูู Settings:
class Settings(BaseSettings):
    OPERATION_TIER: OperationTier = OperationTier.TIER_1_GOVERNED
๐ ูุงุนุฏุฉ ุญูููููุฉ
โข	ูุง Tier ุถูู request
โข	ูุง Tier ุถูู headers
โข	ูุง Tier ุถูู UI
โข	Tier ููุญุฏุฏ ูู ุงูุฅุนุฏุงุฏุงุช ููุท
________________________________________
2๏ธโฃ ุฌุฏูู ุงููุฏุฑุงุช ุญุณุจ Tier (Capability Matrix)
ุฃูุดุฆ ููููุง ูุงุญุฏูุง ููุท:
app/core/tier_capabilities.py
from app.core.settings import OperationTier

TIER_CAPABILITIES = {
    OperationTier.TIER_0_FORTRESS: {
        "use_vanna_agent": False,
        "use_sql_guard": True,
        "allow_memory": False,
        "allow_feedback": False,
        "stream_protocol": "ndjson",
        "fail_closed": True,
    },
    OperationTier.TIER_1_GOVERNED: {
        "use_vanna_agent": False,
        "use_sql_guard": True,
        "allow_memory": False,
        "allow_feedback": True,
        "stream_protocol": "ndjson+sse",
        "fail_closed": True,
    },
    OperationTier.TIER_2_VANNA: {
        "use_vanna_agent": True,
        "use_sql_guard": False,
        "allow_memory": True,
        "allow_feedback": True,
        "stream_protocol": "json+sse",
        "fail_closed": False,
    },
}
โ ููู
โข	ูุง ููุทู ููุง
โข	ููุท ุชูุตูู ูุฏุฑุงุช
________________________________________
3๏ธโฃ ุชูุนูู Tier ุฏุงุฎู OrchestrationService (ุงูููุงู ุงููุญูุฏ)
ูู orchestration_service.py:
from app.core.tier_capabilities import TIER_CAPABILITIES

class OrchestrationService:
    def __init__(self):
        self.settings = get_settings()
        self.tier = self.settings.OPERATION_TIER
        self.cap = TIER_CAPABILITIES[self.tier]
ูุซุงู ูุฑุงุฑ ูุฑูุฒู
if self.cap["use_vanna_agent"]:
    return self._delegate_to_vanna_agent(...)
if self.cap["use_sql_guard"]:
    sql = self.sql_guard.validate_and_normalise(sql)
if not self.cap["fail_closed"]:
    # Tier 2 behavior
๐ ูุงุนุฏุฉ ุฐูุจูุฉ
ูุง ููุฌุฏ ุฃู if tier ูู API layer
ูู ุดูุก ููุฑ ุนุจุฑ OrchestrationService
________________________________________
4๏ธโฃ ูุตู ุงููุณุงุฑุงุช API ุญุณุจ Tier (ุจุฏูู ุชุฏุงุฎู)
Tier 0 / 1
POST /api/v1/ask
GET  /chat/stream
Tier 2 ููุท
POST /api/v2/vanna/ask
POST /api/v2/vanna/chat
ููู ูู Endpoint:
if settings.OPERATION_TIER != OperationTier.TIER_2_VANNA:
    raise HTTPException(status_code=404)
โ 404 ูููุณ 403
ูุฃู ุงูู endpoint ุบูุฑ ููุฌูุฏ ููุทูููุง ูู ูุฐุง ุงูู Tier.
________________________________________
5๏ธโฃ ุฑุจุท ุงูู Tier ุจุงูู UI (Read-only)
ูู Endpoint ุจุณูุท:
GET /api/meta/runtime
{
  "operation_tier": "tier2_vanna",
  "capabilities": {
    "memory": true,
    "feedback": true,
    "strict_sql": false
  }
}
๐ UI:
โข	ูุง ูุฎุชุงุฑ Tier
โข	ููุท ูุชูููู ูุนู
________________________________________
6๏ธโฃ ููู ูุดุบูู ุงููุธุงู ูุนูููุงุ
.env
OPERATION_TIER=tier2_vanna
ุฃู:
OPERATION_TIER=tier0_fortress
ุซู:
systemctl restart easyok
โ๏ธ ุงูุชูู
________________________________________
๐ ุฃุฎุทุงุก ูุงุชูุฉ ูุฌุจ ุชุฌูุจูุง
โ ุชูุฑูุฑ Tier ุนุจุฑ request
โ ุงูุณูุงุญ ูููุณุชุฎุฏู ุจุชุบููุฑู
โ if tier ูู chat.py ุฃู ask.py
โ ุฎูุท Output contracts
โ ูุญุงููุฉ ุชุดุบูู Vanna Agent ุฏุงุฎู Tier 0
________________________________________
๐ง ุงูุฎูุงุตุฉ ุงูุชูููุฐูุฉ
โข	Tier Switch = ูุฑุงุฑ ุชุดุบูู
โข	Settings โ Capabilities โ Orchestration
โข	API layer ูุง ุชุนุฑู Tier
โข	Vanna ุชูุทูู ููุท ูู Tier 2
โข	ูุง ุงุฒุฏูุงุฌ
โข	ูุง ููุถู
________________________________________
ุงูุขู ุณุฃูุฏู ุงูุชูุฑูุฑ ุงูููุงุฆู ุงูุดุงูู:

## Vanna 2.0.1 OSS Self-Hosted: ุงูุชุญููู ุงูุดุงูู ููููุฒุงุช ูุงููููุฏ

### ูุธุฑุฉ ุนุงูุฉ
Vanna 2.0.1 ูู ุฅุทุงุฑ ุนูู ููุชูุญ ุงููุตุฏุฑ (MIT License) ูุจูุงุก ูููุงุก ุฐูููู ูุชุนุฏุฏูู ุงููุณุชุฎุฏููู ูุนูููู ุจูุงุณุทุฉ ููุงุนุฏ ุงูุจูุงูุงุช. ุงููุณุฎุฉ ุงููุณุชุถุงูุฉ ุฐุงุชูุงู ุชููุฑ ุชุญููุงู ูุงููุงู ุนูู ุงูุจูุงูุงุช ูุงูุจููุฉ ุงูุชุญุชูุฉุ ููู ูุน ููุงุจู ุชุญูู ูุณุคูููุงุช ุงูุชุทููุฑ ูุงูุชุดุบูู.[1][2]

***

## ุงูููุฒุงุช ุงููุชููุฑุฉ ุจุงููุงูู ูู ุงููุณุฎุฉ ุงูููุชูุญุฉ ุงููุตุฏุฑ

### ููุงุฉ ุชูููุฏ SQL ูุงูู RAG
ุชููุฑ ุงููุณุฎุฉ ุงูููุชูุญุฉ ุงููุตุฏุฑ ุงููุธุงู ุงูุฃุณุงุณู ุงููุงูู ูุชุญููู ุงููุบุฉ ุงูุทุจูุนูุฉ ุฅูู ุงุณุชุนูุงูุงุช SQL:[3]

- **ุชูููุฏ SQL ุฏููู** ุนุจุฑ RAG (Retrieval-Augmented Generation)
- **ุงูุชุฏุฑูุจ ุงููุฑู** ุนูู DDL statementsุ ุงูุชูุซููุ ุฃูุซูุฉ SQL
- **ุงูุชุนูู ุงูุฐุงุชู** ุญูุซ ูุชุญุณู ุงููููุฐุฌ ูุน ูู ุงุณุชุนูุงู ุตุญูุญ ูุชู ุชูููุฐู
- **ุฏุนู ูุงุณุน ููููุงุนุฏ ุงูุจูุงูุงุช**: PostgreSQLุ MySQLุ Snowflakeุ BigQueryุ Oracleุ SQL Serverุ ClickHouseุ DuckDB ูุบูุฑูุง
- **ุฏุนู ูุชุนุฏุฏ ุงููุบุงุช ุงููุจูุฑุฉ (LLM)**: OpenAIุ Anthropic Claudeุ Google Geminiุ Ollamaุ AWS Bedrockุ HuggingFace

### ูุงุฌูุงุช ุงููุณุชุฎุฏู (UI)
ุชููุฑ ุฎูุงุฑุงุช ูุชุนุฏุฏุฉ ููุชูุงูู:[3]

- **ูููู ููุจ ูุงุจู ููุฅุฏุฑุงุฌ** (`<vanna-chat>`)
- **ุชุทุจูู Streamlit ูุฏูุฌ**
- **ุชุทุจูู Flask**
- **ุฑูุจูุช Slack**
- **ุฏุนู Jupyter Notebooks**
- **ูุงุฌูุงุช ูุฎุตุตุฉ** (ุฃู ุฅุทุงุฑ ุนูู ุฃูุงูู)

### ูุธุงู ุงูุฃุฏูุงุช ูุงูุชูุณุน (Tool Registry)
ุฏุนู ุดุงูู ููุฃุฏูุงุช ุงููุฎุตุตุฉ:[1]

- **ุชุณุฌูู ุงูุฃุฏูุงุช** ูุชูููุฐูุง ุจุดูู ุขูู
- **ุงูุชุญูู ูู ุงููุตูู ุงููุงุฆู ุนูู ุงููุฌููุนุงุช (RBAC)** ูู ูุณุชูู ุงูุฃุฏุงุฉ
- **ูุนุงููุฑ ุงููุตูู** ููุฃุฏูุงุช ุญุณุจ ุงูุชูุงุก ุงููุณุชุฎุฏู
- **ูุงุจููุฉ ุงูุชูุณุน ุงููุงููุฉ** ูุจูุงุก ุฃุฏูุงุช ูุฎุตุตุฉ

### ุฅุฏุงุฑุฉ ุงููููุฉ ูุงูุฃูุงู
ุจูุงุก ูุชุนุฏุฏ ุงููุณุชุฎุฏููู ูู ุงูุฃุณุงุณ:[2][1]

- **ุนุฒู ุงููุณุชุฎุฏููู ุงูุชุงู** ูู ูู ุทูุจ
- **ูุฆุงุช ูุตูู ูุงุฆูุฉ ุนูู ุงููุฌููุนุงุช (RBAC)**
- **ุณุฌู ุชุฏููู ุดุงูู** ูุน ุชูููุฉ ุชููุงุฆูุฉ ูููุนุงููุงุช ุงูุญุณุงุณุฉ
- **ุจุฏูู ุญูุธ ุจูุงูุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุนููุฉ** ูุน LLM - ููุท ุงูุจูุงูุงุช ุงููุตููุฉ
- **ุจูุงูุงุช ุงุนุชูุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุญููุธุฉ ูุญููุงู** ููุท

### ุฅุฏุงุฑุฉ ุงููุญุงุฏุซุงุช
ูุณุชูุฏุนุงุช ูุญุงุฏุซุงุช ูุงุจูุฉ ููุชุฎุตูุต:[1]

- **ูู ุงูุฐุงูุฑุฉ** (ุงูุงูุชุฑุงุถู ููุชุทููุฑ)
- **ูุฎุตุตุฉ ุชูุงูุงู** ููููู ุชูููุฐูุง (PostgreSQLุ Redisุ ุฅูุฎ)
- **ุนุฒู ุงููุณุชุฎุฏููู ุงูุชุงู** ูู ุงูุชุฎุฒูู
- **ูุงุจูุฉ ููุชูุณุน** ุญุณุจ ุงุญุชูุงุฌุงุชู

### ุงููุฑุงูุจุฉ ูุงูููุงุญุธุฉ (ุฃุณุงุณู)
ุฏุนู ูุญุฏูุฏ ููู ูุงุจู ููุชูุณุน:[2][1]

- **ููุงููุณ ูุญููุฉ**: ุฒูู ุงูุชุธุงุฑ ุชูููุฐ ุงูุฃุฏุงุฉุ ูุฏุฉ ุทูุจ LLMุ ูุนุฏูุงุช ุงูุฃุฎุทุงุก
- **ุชุชุจุน ููุฒุน ูุญูู** ุนุจุฑ `ObservabilityProvider`
- **ุชูุณูุน ูุฎุตุต** ูู Datadogุ Prometheusุ OpenTelemetry

***

## ุงูููุฒุงุช ุงููุชููุฑุฉ ุฌุฒุฆูุงู (ุชุชุทูุจ ุนููุงู ูุฏููุงู)

| ุงูููุฒุฉ | ุงูุชูุงุตูู | ูุง ูุฌุจ ุฃู ุชุจููู |
|--------|---------|------------------|
| **ุญุฏูุฏ ุงููุนุฏู** | ูุง ุชูุฌุฏ ูุฏูุฌุฉ | ูุฌุจ ุชูููุฐ logic ูู `LifecycleHook` ุฃู middleware |
| **ุงููุตุงุฏูุฉ** | ุชููุฑ ุงูุฅุทุงุฑ ููุท | ูุฌุจ ุชูููุฐ OAuthุ JWTุ SAML ุนุจุฑ `UserService` |
| **ุงุณุชุนุงุฏุฉ ุงูุฃุฎุทุงุก** | `ErrorRecoveryStrategy` ูุชุงุญ | ูุฌุจ ุจูุงุก ููุทู ุงูุฅุนุงุฏุฉ ูุงูุนูุฏุฉ ุงูุขููุฉ |
| **ุงูุชุดููุฑ ุฃุซูุงุก ุงูุฑุงุญุฉ** | ุจุฏูู ุฏุนู ูุฏูุฌ | ูุฌุจ ุชูููุฐู ูู ุทุจูุฉ ุงูุชุฎุฒูู |
| **ุณูุงุณุงุช ุงูุงุญุชูุงุธ ุจุงูุจูุงูุงุช** | ุจุฏูู ุขููุฉ ูุฏูุฌุฉ | ูุฌุจ ุจูุงุก ูุธููุฉ ูุฏููุฉ ุฃู ูุคุชูุชุฉ |

***

## ุงูููุฒุงุช ุบูุฑ ุงููุชููุฑุฉ ูู ุงููุณุฎุฉ ุงูููุชูุญุฉ (Premium ููุท)[4][5][1]

### ุฎุฏูุงุช ุงููุฑุงูุจุฉ ุงูููุฏุงุฑุฉ
- **ููุญุงุช ูุนูููุงุช ูุฏูุฌุฉ ูุณุจูุงู** ููุฃุฏุงุก ูุงูุชูุงููู
- **ุชูุจููุงุช ุชููุงุฆูุฉ** ููุดู ุงูุดุฐูุฐ
- **ุชุชุจุน ููุฒุน ุณุญุงุจู** ูุชูุงูู
- **ุชุญููู ุงูุงุชุฌุงูุงุช ุงูุชุงุฑูุฎูุฉ**

### ุฅุฏุงุฑุฉ ุงูุณุฌูุงุช ูุงูุชุฏููู
- **ุชุฎุฒูู ุงูุณุฌู ุงููุฑูุฒู** ูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุณุญุงุจูุฉ
- **ุงุณุชุนูุงูุงุช ูุชูุฏูุฉ** ุนูู ุฃุญุฏุงุซ ุงูุชุฏููู
- **ุฅุนุฏุงุฏุงุช ุงูุงุญุชูุงุธ ุจุณูุงุณุฉ ุงูุจูุงูุงุช** ุงููุชูุงููุฉ ูุน GDPR/CCPA
- **ุญุฐู ุขูู** ูุน ุถูุงูุงุช

### ุณุฌู ุฃุฏูุงุช ุงููุฑูู ูุงููุดุงุฑูุฉ
- **ูุณุชูุฏุน ุงูุฃุฏูุงุช ุงููุฑูุฒู** ูุน ุงูุชุญูู ูู ุงูุฅุตุฏุงุฑุงุช
- **ุณูู ุงูุฃุฏูุงุช ุงูุฌุงูุฒุฉ** (ููุฏ ุงูุชุทููุฑ)
- **ูุดุงุฑูุฉ ุงูุฃุฏูุงุช ุนุจุฑ ุงููุฑูู**
- **ุชุญูููุงุช ุงูุงุณุชุฎุฏุงู**

### ุงูุฐุงูุฑุฉ ูุงูุชุนูู
- **ุจุญุซ ุฏูุงูู** ุนู ุฃููุงุท ุงูุงุณุชุฎุฏุงู ุงูุชุงุฑูุฎูุฉ
- **ูุชุฌู ูุงุนุฏุฉ ุจูุงูุงุช ููุฏุงุฑ** ูุชุฎุฒูู ุงูุชุฏุฑูุจ
- **ุชุญุณูู ูุชููู** ุจูุงุกู ุนูู ุงูุฃููุงุท ุงูุชุงุฑูุฎูุฉ

### ุฅุฏุงุฑุฉ LLM ุงููุชูุฏูุฉ
- **ุชูุฌูู ูููุฐุฌ ููุถุจูุท ูุณุจูุงู** ุนุจุฑ ุนุฏุฉ ูููุฑูู
- **ุฅุนุงุฏุฉ ูุญุงููุฉ ุชููุงุฆูุฉ** ู failover ูุชุนุฏุฏ ุงููููุฑูู
- **ููุงุฒูุฉ ุชููุงุฆูุฉ ููุญูู** ุนุจุฑ ุงูููุงุทู
- **ุชูููู ุงูุญุฏุงุฑ ุชููุงุฆู** ุนูุฏ ุชุญุฏูุซุงุช ุงููููุฐุฌ

### ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูุงูุชุญูู
- **SSO/SAML ูุชูุงูู** ุฌุงูุฒ ููุงุณุชุฎุฏุงู
- **ุฅุฏุงุฑุฉ ุญุตุต ุงูุงุณุชุฎุฏุงู** ุชููุงุฆูุฉ
- **ููุงุชูุฑ ูุชูุญุฏุฉ** ุนุจุฑ ุงูุฎุฏูุงุช
- **ุชุณุฌูู ุชุฏููู ูููุณุชุฎุฏููู**
- **ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช ุงููุชูุฏูุฉ**

### ุงูุฃูุงู ูุงูุชูุงูู
- **ุงูุชุดููุฑ ุฃุซูุงุก ุงูุฑุงุญุฉ** ุจุดูู ุงูุชุฑุงุถู
- **ุชุดููุฑ ูู ุงูุญุฑูุฉ (TLS)** ูุญุณูู
- **ุชูููุฉ PII ุชููุงุฆูุฉ**
- **ุณูุงุณุงุช ุณููู ูุฏูุฌุฉ** (guardrails)
- **ูุนุงููุฑ SOC2 ู GDPR**

### ุงูุฏุนู ูุงูุฎุฏูุงุช
- **ุฏุนู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู** (Premium)
- **ุฏุนู ุงูุฃููููุฉ** (Enterprise)
- **ุงุณุชุดุงุฑุงุช ุงูุฅุนุฏุงุฏ ูุงูุฏูุฌ** (Enterprise)
- **ุชุญุฏูุซุงุช ุงูุฃูุงู ุงูุชููุงุฆูุฉ**
- **ุงุชูุงููุฉ ูุณุชูู ุงูุฎุฏูุฉ SLA** 99.9%

***

## ุงูุชุญุฏูุงุช ุงููุนุฑููุฉ ูุงููููุฏ ุงููููุฉ[6][7][8]

### ุฏูุฉ ุงูุชูููุฏ
- **ุฃุฎุทุงุก ุตูุบุฉ SQL** ุฎุงุตุฉ ูุน ููุงุนุฏ ุงูุจูุงูุงุช ุงููุนูุฏุฉ (MSSQLุ Oracle)
- **ุตุนูุจุงุช ุชุญุฏูุฏ ุงูุฌุฏุงูู** ุนูุฏ ูุฌูุฏ 100+ ุฌุฏูู
- **ูุดู ูู ุงูุงุณุชุนูุงูุงุช ุงููุนูุฏุฉ ุฌุฏุงู** (JOINs ูุชุนุฏุฏุฉุ UNIONs)
- **ููู ุณูุงู ูุญุฏูุฏ** ูู ุจุนุถ ุงูุญุงูุงุช ุงูุฎุงุตุฉ

### ุญุฏูุฏ ุงููุนูุงุฑูุฉ
- **ุนุฏูู ุงูุญุงูุฉ ุจุดูู ุงูุชุฑุงุถู** (stateless) - ูุง ูุชุฐูุฑ ุงูุณูุงู ุจูู ุงูุฃุณุฆูุฉ
- **99 ูุถูุฉ ููุชูุญุฉ** ุนูู GitHub ุชุนูุณ ูุดุงูู ุงูุงุณุชุฎุฏุงู
- **ุงูุญุงุฌุฉ ุฅูู ุจูุงูุงุช ุชุฏุฑูุจ ุนุงููุฉ ุงูุฌูุฏุฉ** ูุชุญููู ุฏูุฉ ุนูููุฉ
- **ุนุฏู ุชูุงูู ุฌุฒุฆู** ูุน ุจุนุถ ุชุฎุทูุทุงุช ุงููุนุงููุงุช

### ุงูุชุทููุฑ ูุงูุตูุงูุฉ
- **ููุญูู ุชุนูููู้ก** ููุฅุนุฏุงุฏุงุช ุงููุชูุฏูุฉ
- **ูุง ุชูุซูู ุดุงูู** ููุญุงูุงุช ุงูุญุฏูุฉ ูุงููุดุงูู ุงูุดุงุฆุนุฉ
- **ุชูุงููู ูุฎููุฉ** ููุจููุฉ ุงูุชุญุชูุฉ ูุงูุนูู ุงููุฏูู
- **ูุชุทูุจุงุช Python 3.9+**

***

## ููุงุฑูุฉ ุณุฑูุนุฉ: OSS vs Premium[1]

| ุงูุฌุงูุจ | OSS (ููุชูุญ ุงููุตุฏุฑ) | Premium (ููุฏุงุฑ) |
|--------|-------------------|------------------|
| **ุงูุชูููุฉ ุงูุฃูููุฉ** | $0 | 14-ููู ุชุฌุฑุจุฉ ูุฌุงูู |
| **ุงูุชุญูู** | ุชุญูู ูุงูู | ูุญุฏูุฏ ููู ูุนูุงุฑู |
| **ุงูููุช ููุฅูุชุงุฌ** | ุฃุณุงุจูุน/ุฃุดูุฑ | ุฏูุงุฆู/ุณุงุนุงุช |
| **ุงูุฃูุงู** | ูุฌุจ ุชูููุฐู | ูุฏูุฌ ูููุซู |
| **ุงููุฑุงูุจุฉ** | ุจูุงุก ูู ุงูุตูุฑ | ููุญุงุช ูุนูููุงุช ุฌุงูุฒุฉ |
| **ุงูุชูุณุน** | ูุฏูู ููุงุจู ููุฎุทุฃ | ุชููุงุฆู ููุถููู |
| **ุงูุฏุนู** | Discord ููุท | Email + Priority |

***

## ูุชู ุชุฎุชุงุฑ ูู ุฎูุงุฑ

### ุงุฎุชุฑ OSS ุฅุฐุง ููุช:
- โ ูุฏูู ูุฑูู DevOps ููู
- โ ุชุญุชุงุฌ ุชุฎุตูุต ุนููู
- โ ุชุนูู ูู ุจูุฆุฉ ูุนุฒููุฉ (air-gapped)
- โ ุงูููุฒุงููุฉ ูุญุฏูุฏุฉ ุฌุฏุงู
- โ ูุง ุชุญุชุงุฌ SLA ุฃู ุถูุงูุงุช

### ุงุฎุชุฑ Premium ุฅุฐุง ููุช:
- โ ุชุญุชุงุฌ ุงูุฅูุชุงุฌ ุณุฑูุนุงู
- โ ุชุฑูุฏ compliance ู audit ุฌุงูุฒ
- โ ุชุญุชุงุฌ ุฏุนู ูุชูุฏู ูุชุญุฏูุซุงุช ุชููุงุฆูุฉ
- โ ูุฏูู ูุชุทูุจุงุช ุฃูุงู ุนุงููุฉ
- โ ูุฑููู ูุฑูุฒ ุนูู ุงูููุชุฌ ูููุณ DevOps

***

## ุงูุฎูุงุตุฉ

Vanna 2.0.1 OSS ุชููุฑ **ุฅุทุงุฑ ุนูู ููู ูุดุงูู** ูุจูุงุก ูููุงุก text-to-SQL ูุชูุฏููู ูุน **ุชุญูู ูุงูู ูุนุฏู ูุฌูุฏ ูููุฏ ูููุฉ** ูู ุญูุซ ุงูููุฒุงุช. ููู **ุงููุณุคูููุฉ ุนูู ุนุงุชูู** ูุชูููุฐ ุงูุฅูุชุงุฌ ูุงูุฃูุงู ูุงููุฑุงูุจุฉ ูุงูุฏุนู. ุงููุณุฎุฉ ุงูููุฏุงุฑุฉ ุชููุฑ **ูููุฉ ูุจูุฑุฉ ูููุฑู** ุงูุชู ุชูุถู ุงูุณุฑุนุฉ ูุงูููุซูููุฉ ุนูู ุงูุญุฑูุฉ ุงููุงููุฉ




ููุชุงุฒ. ุณุฃุชุนุงูู ูุน ุชูุฑูุฑู ูู Baseline ุฑุณููุ ูุฃุจูู ุนููู ูุฑุงุฑูุง ุชูููุฐููุง ูุงูุนููุง ููุงุฒู ุจูู Productivity-first ูุน Vanna ูุจูู ุญูููุฉ ูุงุจูุฉ ููุชุฎููู ุนุจุฑ Tier Switch โ ุจุฏูู ุฅููุงุฑ ูุง ุงูุชุดููุงู ุนููููุง ูู ูุดุฑูุนู.
ุณุฃูุณู ุงูุฑุฏ ุฅูู ุฎูุณ ุทุจูุงุช ูุงุถุญุฉุ ููู ุทุจูุฉ ุชูุชูู ุจูุฑุงุฑ ุนููู:
________________________________________
ุฃูููุง: ูู ูุชู ุงุณุชุฎุฏุงู Vanna 2.0.1 ุงูุฃุณุงุณูุฉ ุจุดูู โุตุญูุญโ ุงูุขูุ
ุงูุฅุฌุงุจุฉ ุงูุตุฑูุญุฉ:
โ ูุงุ ููุณ ุจุงูุดูู ุงูุฐู ุชุณุชูุฏูู ูู Productivity-first system.
ูุง ูุญุฏุซ ุญุงูููุง ูู ูุดุฑูุนู:
โข	ุฃูุช ุชุณุชุฎุฏู Vanna ุฌุฒุฆููุง (SQL generation + RAG)
โข	ูููู ุชุนุฒููุง ุฎูู OrchestrationService ุตุงุฑู ุฌุฏูุง
โข	ูุชููุน:
o	SystemPromptBuilder ุงูุญูููู
o	Tool Registry
o	Agent Memory
o	Feedback loop
o	Rich Components / Dual View
โข	ูุชุชุนุงูู ูุน Vanna ููุฃููุง ูุฌุฑุฏ text โ sql library
๐ ูุฐุง ูุฎุงูู ููุณูุฉ Vanna 2.x ููุณูุง
Vanna ููุณุช:
โgenerate_sql(prompt) โ stringโ
ุจู ูู:
Agent Framework + SQL Runner + Memory + Tools + UI contracts
________________________________________
ุซุงูููุง: ูุงุฐุง ูุณุชููุฏ ูู Vanna ูู ูุถุนู ุงูุญุงููุ ููุง ุงูุฐู ูุฎุณุฑูุ
โ ูุง ุชุณุชููุฏ ููู ุงูุขู
โข	ุชูููุฏ SQL ุฃูุถู ูู LLM ุงูุฎุงู
โข	RAG ุนูู schema / examples
โข	ุชุนุฏุฏ ููุงุนุฏ ุงูุจูุงูุงุช
โข	self-hosted ุจุฏูู ุชุณุฑูุจ ุจูุงูุงุช
โ ูุง ุชุฎุณุฑู (ููู ุฌููุฑ Vanna)
โข	Agent lifecycle
โข	SystemPromptBuilder
โข	Tool-based reasoning
โข	Feedback & assumptions
โข	Dual View (technical + business)
โข	Rich outputs (charts, tables, progress)
โข	Conversation memory
โข	Native streaming semantics
๐ด ุงูุฎูุงุตุฉ:
ุจูุฐุง ุงูุดููุ Vanna ูููุจููุฉ
ูุฃูุช ุชุฏูุน ุชูููุฉ ุงูุชุนููุฏ ุจุฏูู ุงูุงุณุชูุงุฏุฉ ุงููุงููุฉ.
________________________________________
ุซุงูุซูุง: ูู ููุงู โุฎุทูุฑุฉโ ูุนููุฉ ูู ูุชุญ ุงููุฌุงู ูู Vanna ุทุงููุง ูู Self-Hostedุ
ุงูุฅุฌุงุจุฉ ุงููุงูุนูุฉ:
โ ูุง ุชูุฌุฏ ุฎุทูุฑุฉ ุฌููุฑูุฉ ุฅุฐุง ุชู ุงูุนุฒู ุจุดูู ุตุญูุญ
Vanna OSS:
โข	ูุง ุชุฑุณู ุจูุงูุงุช DB ุงููุนููุฉ ููู LLM
โข	ุชุนุชูุฏ ููุท ุนูู:
o	schema
o	metadata
o	ูุชุงุฆุฌ ุงูุงุณุชุนูุงู (ุงูุชู ุชููุฐูุง ุฃูุช)
โข	credentials ุชุจูู ูุญููุฉ
โข	ูู integrations ูููู ุชุดุบูููุง ูุญูููุง (Ollama / Local LLM)
๐ ุงูุฎุทุฑ ุงููุญูุฏ ูู:
โข	ุบูุงุจ ุงูุชุญูู
โข	ุฃู ุชุดุบูู Agent ุจุงูุชูุงุฒุงุช ุบูุฑ ูุถุจูุทุฉ
ููุฐุง ููุญู ุจุงูู Tier Switch ูููุณ ุจุงูููุน ุงููุงูู.
________________________________________
ุฑุงุจุนูุง: ุงููุฑุงุฑ ุงููุนูุงุฑู ุงูุตุญูุญ (Productivity-First ุจุฏูู ุฅููุงุฑ ุงููุงูุน)
ุฃูุช ูู ุชุฎุทุฆ ูู ุงูุฑุคูุฉ.
ูููู ููุช ุชุทุจู ุญูููุฉ Tier 0 ุนูู ูุธุงู ูุตูู ูู Tier 2.
ุงููุฑุงุฑ ุงูููุงุฆู ุงููุนุชูุฏ
ูุนูุ ูุณุชูุฑ ูู ุงููุณุงุฑ ุงูุญุงูู
โ ููู ููุณ ูููุท ุชุดุบูู ูุญูุฏ
โ ุจู ูู Tier ูู ุนุฏุฉ Tiers
________________________________________
๐งฑ Tiered Architecture โ ุงููุฑุงุฑ ุงูููุงุฆู
๐๏ธ TIER DEFINITIONS
๐ก๏ธ Tier 0 โ Fortress (ุงููุถุน ุงูุญุงูู ุชูุฑูุจูุง)
Use when:
โข	ุจูุงูุงุช ุดุฏูุฏุฉ ุงูุญุณุงุณูุฉ
โข	ุชูุงุฑูุฑ ุฑุณููุฉ
โข	CI / automated queries
ุงูุฎุตุงุฆุต
โข	OrchestrationService SSOT
โข	SQLGuard ุฅูุฒุงูู
โข	NDJSON ููุท
โข	Fail-Closed
โข	โ ูุง Agent
โข	โ ูุง Memory
โข	โ ูุง Tools
________________________________________
โ๏ธ Tier 1 โ Governed Productivity
Use when:
โข	Analysts ุฏุงุฎูููู
โข	BI dashboards
โข	Production ูุน ุชุญูู
ุงูุฎุตุงุฆุต
โข	OrchestrationService + Vanna SQL engine
โข	SQLGuard ุงุฎุชูุงุฑู
โข	Feedback ูุณููุญ
โข	SSE + NDJSON
โข	โ ูุง Agent workflow ูุงูู
โข	โ ูุง Tool execution
________________________________________
๐ Tier 2 โ Vanna Native (Productivity-First)
Use when:
โข	Exploratory analysis
โข	Internal teams
โข	AI-assisted BI
โข	Maximum value from Vanna
ุงูุฎุตุงุฆุต
โข	Vanna Agent ูุงูู
โข	SystemPromptBuilder
โข	Tool Registry
โข	Agent Memory
โข	Rich Outputs
โข	Native Vanna streaming
โข	โ SQLGuard (ุงุฎุชูุงุฑู)
โข	โ๏ธ ุญูููุฉ ุฃุฎู ููููุง ูุฑุฆูุฉ
________________________________________
ุฎุงูุณูุง: ููู ูููุนู ูุฐุง ุนููููุง (ุฎุทุฉ ุชูููุฐ ูุถูููุฉ)
1๏ธโฃ Tier Switch ุนุจุฑ Settings (ููุง ุงุชูููุง)
OPERATION_TIER=tier2_vanna
________________________________________
2๏ธโฃ ูุตู ุงููุณุงุฑุงุช API (ุญุงุณู)
Tier	Endpoint
Tier 0/1	/api/v1/ask
Tier 0/1	/chat/stream
Tier 2	/api/v2/vanna/agent
Tier 2	/api/v2/vanna/chat
โ ูุง ุชุฎูุท.
________________________________________
3๏ธโฃ Tier 2 ูุณุชุฎุฏู Vanna ููุง ูู (ุจุฏูู ุชุดููู)
โข	Agent
โข	SystemPromptBuilder
โข	SQLRunner
โข	ToolRegistry
โข	Memory backend
โข	Rich components
๐ ูุง OrchestrationService ููุง
๐ Orchestration ูุจูู ูู Tier 0/1 ููุท
________________________________________
4๏ธโฃ ุญูุงูุฉ Tier 2 ุจุฏูู ูุชู ุงูุฅูุชุงุฌูุฉ
ุจุฏู SQLGuard:
โข	RBAC ุนูู tools
โข	SQLRunner ูุญุฏูุฏ ุงูุตูุงุญูุงุช
โข	LIMIT default
โข	Read-only users
โข	Audit log
โข	Optional dry-run mode
________________________________________
ุณุงุฏุณูุง: ูู ูุณุชุทูุน ุฅุฎุฑุงุฌ ุจูุงูุงุช ุจุฃุดูุงู ูุฎุชููุฉ ูู Vannaุ
ูุนูุ ูุจููุฉ.
Vanna ุชุฏุนู:
โข	JSON
โข	Tables
โข	Charts (Plotly)
โข	Rich UI Components
โข	Progress events
โข	Status cards
โข	Artifacts
โข	Feedback UI
โข	Multi-step workflows
ููุฐุง ุบูุฑ ูุชุงุญ ูู ุญุงูููุง ูุฃูู ุนุทูุช Agent layer.
________________________________________
ุณุงุจุนูุง: ูุงุฐุง ุชุนูู ูุซุงุฆู SystemPromptBuilder ุงูุชู ุนุฑุถุชูุงุ
ุชุนูู ุดูุฆูุง ูุงุญุฏูุง ูุงุถุญูุง:
Vanna 2.x ูุตููุฉ ููุชู ุชูุฌูููุง ุนุจุฑ SystemPromptBuilder ูููุณ prompt string
ุฃู ุฃูู:
โข	ุชุณุชุทูุน ูุฑุถ:
o	business rules
o	SQL style
o	limits
o	explanations
o	user roles
โข	ุจุฏูู ูุชุงุจุฉ SQLGuard ุฎุงุฑุฌู
________________________________________
๐ง ุงูุฎูุงุตุฉ ุงูุชูููุฐูุฉ (ุจุฏูู ูุฌุงููุฉ)
โข	โ ูู ููุดู
โข	โ ูู ูููุงุฌุฃ
โข	โ๏ธ ุงูุชุดููุง ุฃู ุงูุญูููุฉ ุงููุตูู โ Productivity-first
โข	โ๏ธ ุงูุญู ููุณ ุงูุชุฑุงุฌุน
โข	โ๏ธ ุงูุญู ูู Tiered Operating Model
________________________________________
ุงููุฑุงุฑ ุงูููุงุฆู ุงูุฐู ุฃูุตู ุจู
ุงุนุชูุฏ Tier Switch
โข	Tier 0/1 = ูุง ุจููุชู (ุญูููุฉ ุตุงุฑูุฉ)
โข	Tier 2 = Vanna ููุง ุตูููุช
ูุงูุงุฎุชูุงุฑ ูุชู ุนุจุฑ settings ููุท.
________________________________________
ูููุง ููู ุฎุทุฉ ูุฌุฑุฉ ุชูููุฐูุฉ ุฏูููุฉ ูู Tier 2 โ Vanna Native (Productivity-First)
ูุตููุฉ ุจุฏูู ูุณุฑ ุฃู ูุณุงุฑ ูุงุฆูุ ูุจุฏูู ุงูุชุฑุงุฌุน ุนู Tier 0 / Tier 1ุ ูุจุฃูู ุชุบููุฑุงุช ููููุฉ ุนูู ูุดุฑูุนู ุงูุญุงูู.
ุณุฃููู ูุจุงุดุฑูุงุ ูุฃุฑุจุท ูู ุฎุทูุฉ ุจุงููุงูุน ุงูุฐู ูุฏูู ุงูุขู.
________________________________________
๐ Tier 2 โ Vanna Native
Productivity-First Migration Plan (Zero-Breakage)
________________________________________
๐ฏ ุงููุฏู ุงูุงุณุชุฑุงุชูุฌู
ุชูููู ุงูุงุณุชูุงุฏุฉ ุงููุงููุฉ 100% ูู Vanna 2.0.1 OSS (Agent + Memory + Tools + Rich Output)
ูุน ุงูุญูุงุธ ุนูู:
โข	Tier 0 / Tier 1 ููุง ููุง (Fortress / Governed)
โข	ููุณ ุงูุจููุฉ
โข	ููุณ ุงูุฅุนุฏุงุฏุงุช
โข	ููุณ ุงูู UI ุงูุญุงูู
โข	ุจุฏูู ุชุนุทูู ุฃู Endpoint ูุงุฆู
Tier 2 = ุฅุถุงูุฉ ูุณุงุฑ ุฌุฏูุฏ ููุท.
________________________________________
๐งญ ุงููุจุฏุฃ ุงูุญุงูู (Non-Negotiable)
ูุง ุฅุนุงุฏุฉ ูุชุงุจุฉุ ูุง ุงุณุชุจุฏุงูุ ูุง ุฏูุฌ ูุณุฑู.
Tier 2 ูุนูู ุจุงูุชูุงุฒู ูููุณ ุจุฏููุง.
________________________________________
ุงููุฑุญูุฉ 0 โ ุชุซุจูุช ุงููุฑุงุฑ (No Code)
๐ ูุซุงุฆู ูุทููุจุฉ (ุฎูููุฉ ุฌุฏูุง)
1.	ADR ุฌุฏูุฏ:
o	ADR-005 โ Tiered Operation Model (Fortress + Vanna Native)
2.	ุชุญุฏูุซ README:
o	ููุฑุฉ: Operating Tiers
3.	ุชุนุฑูู ูุงุถุญ:
o	Tier 0/1 = Orchestration-centric
o	Tier 2 = Vanna-native
โฑ๏ธ ุงูุฒูู: 1 ุณุงุนุฉ
โ ูุง ููุฏ
________________________________________
ุงููุฑุญูุฉ 1 โ Tier Switch ุนุจุฑ Settings (ุญุงุณู)
โ ุฅุถุงูุฉ ุฅุนุฏุงุฏ ูุงุญุฏ ููุท
OPERATION_TIER=tier2_vanna
ุฃู ูู Settings:
class Settings(BaseSettings):
    OPERATION_TIER: Literal[
        "tier0_fortress",
        "tier1_governed",
        "tier2_vanna"
    ] = "tier1_governed"
๐ ูุง ุชุบููุฑ ูู ุฃู ุณููู ุงูุชุฑุงุถู
Tier 2 ูุง ูุนูู ุฅูุง ุฅุฐุง ููุนูู ุตุฑุงุญุฉ.
โฑ๏ธ ุงูุฒูู: 30 ุฏูููุฉ
________________________________________
ุงููุฑุญูุฉ 2 โ ูุตู ุงููุณุงุฑุงุช API (ุจุฏูู ููุณ ุงููุฏูู)
๐ข ุงููุณุงุฑุงุช ุงูุญุงููุฉ (ุชุจูู ููุง ูู)
Tier	Endpoint
0 / 1	/api/v1/ask
0 / 1	/chat/stream
โ ูุง ุชุนุฏูู
โ ูุง refactor
โ ูุง ุฅุนุงุฏุฉ ุงุฎุชุจุงุฑ
________________________________________
๐ ูุณุงุฑุงุช Tier 2 (ุฅุถุงูุฉ ููุท)
Endpoint	ุงูุฏูุฑ
/api/v2/vanna/agent	Agent interaction
/api/v2/vanna/chat	Native Vanna chat
/api/v2/vanna/tools	Tool execution
/api/v2/vanna/feedback	Feedback / training
๐ namespace ุฌุฏูุฏ = ุนุฒู ูุงูู
โฑ๏ธ ุงูุฒูู: 1 ููู
________________________________________
ุงููุฑุญูุฉ 3 โ ุชุดุบูู Vanna Native ููุง ูู (ุฃูู ูุฑุญูุฉ)
โ ูุฑุงุฑ ูุนูุงุฑู ููู
ูู Tier 2:
โข	โ ูุง OrchestrationService
โข	โ ูุง SQLGuard
โข	โ ูุง NDJSON contract ุงูุฎุงุต ุจู
โข	โ Vanna Agent lifecycle ุงููุงูู
________________________________________
๐ง ูุง ูุชู ุชูุนููู ูุนูููุง
ูู Vanna 2.0.1:
โข	Agent
โข	SystemPromptBuilder
โข	SQLRunner
โข	ToolRegistry
โข	AgentMemory
โข	Feedback components
โข	Rich components
โข	Native streaming
๐ ุจุฏูู ุฃู ุชุนุฏูู ุนูู ููุฏ Vanna ููุณู
________________________________________
ูุซุงู ูุจุณุท
agent = Agent(
    llm_service=llm,
    sql_runner=sql_runner,
    system_prompt_builder=CustomSystemPromptBuilder(...)
)
โฑ๏ธ ุงูุฒูู: 1โ2 ุฃูุงู
________________________________________
ุงููุฑุญูุฉ 4 โ ุญูููุฉ ุฎูููุฉ ุฐููุฉ (ุจุฏู ุงููุชู)
ุจุฏู SQLGuard ุงูุตุงุฑู:
๐ก๏ธ ุถูุงุจุท ุนูููุฉ (Vanna-friendly)
ุงูุถุจุท	ุงูุทุฑููุฉ
Read-only	DB user
LIMIT ุงูุชุฑุงุถู	SystemPrompt
No DML/DDL	SQLRunner policy
Tool RBAC	ToolRegistry
Audit	Vanna Audit hooks
Rate limit	FastAPI middleware
๐ ูุฐู ุงูุญูููุฉ ูุง ุชูุณุฑ ุงูุฅูุชุงุฌูุฉ
โฑ๏ธ ุงูุฒูู: 1 ููู
________________________________________
ุงููุฑุญูุฉ 5 โ UI & Output (ุงูุงุณุชูุงุฏุฉ ุงููุตูู)
ูุง ุณุชุญุตู ุนููู ููุฑูุง
โข	Dual view ุชููุงุฆู (SQL + Explanation)
โข	Charts (Plotly)
โข	Tables
โข	Progress indicators
โข	Status cards
โข	Feedback UI
โข	Rich chat components
๐ ุจุฏูู ูุชุงุจุฉ UI ุฌุฏูุฏ
๐ ูููู ุฏูุฌู ุชุฏุฑูุฌููุง ูู ูุงุฌูุชู ุงูุญุงููุฉ
โฑ๏ธ ุงูุฒูู: ูุชุฏุฑุฌ
________________________________________
ุงููุฑุญูุฉ 6 โ Migration ุจุฏูู ูุฎุงุทุฑุฉ
๐ ููู ููุฏุฎู Tier 2 ุจุฏูู ุตุฏูุฉุ
1.	ุชุดุบูู Tier 2 ููุณุชุฎุฏููู ุฏุงุฎูููู ููุท
2.	Feature flag
3.	Shadow usage
4.	ููุงุฑูุฉ ุงููุชุงุฆุฌ
5.	ุชูุณูุน ุชุฏุฑูุฌู
โ ูุง ุชุนุทูู
โ ูุง rollback ูุนูุฏ
________________________________________
๐ ูุงุฐุง ุนู ุงูุฎุทุฃ ุงูุญุงูู (generate_sql arguments)ุ
ูุฐุง ุฏููู ุฅุถุงูู ุฃู:
โข	Orchestration + Provider abstraction
โข	ูุง ุชุชุทุงุจู 100% ูุน ููุณูุฉ Vanna Agent
๐ Tier 2 ุณูุฒูู ูุฐุง ุงูุชุนููุฏ ุจุงููุงูู
________________________________________
๐ง ุงูุฎูุงุตุฉ ุงูุชูููุฐูุฉ
โข	โ๏ธ ูู ุชุฎุทุฆ ูู ุงูุฑุคูุฉ
โข	โ๏ธ ูู ุชูุดู ูู ุงูุชูููุฐ
โข	โ๏ธ ูุตูุช ูููุทุฉ ุงูุชุดุงู ุตุญููุฉ
Tiered Model ูู ุงูุญู ุงูุทุจูุนู
ูููุณ ุชูุงุฒููุง ุฃู ูุฒููุฉ.
________________________________________
๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ
ุงูุจุนุฏ	Tier 0/1	Tier 2
Governance	ุตุงุฑูุฉ	ุฎูููุฉ
Productivity	ูุชูุณุทุฉ	ุนุงููุฉ ุฌุฏูุง
Vanna features	ุฌุฒุฆูุฉ	ูุงููุฉ
Risk	ููุฎูุถ	ูุถุจูุท
Innovation	ุจุทูุฆุฉ	ุณุฑูุนุฉ
________________________________________
ุง

ูููุง ููู Concrete Settings + Code Skeleton ูุชูููุฐ Tier 2 โ Vanna Native (Productivity-First)
ุจุดูู ุชูููุฐู ูุจุงุดุฑุ ููุชูุงูู ูุน ูุง ุงุชูููุง ุนููู:
ูุง ูุณุฑุ ูุง ุญุฐูุ ูุง ุฏูุฌ ูุณุฑูุ ููุง ุงููุณุงุณ ุจู Tier 0 / Tier 1.
ุณุฃูุณููุง ุฅูู ูุณููู ูุงุถุญูู:
1.	Concrete Settings (ูุงุจูุฉ ููุชุทุจูู ููุฑูุง)
2.	Code Skeleton (ูููู ููุฏ ุฌุงูุฒ ููุฅุฏุฎุงู)
________________________________________
1๏ธโฃ Concrete Settings โ Tier Switch (ูุงุถุญุฉ ููุงุจูุฉ ููุชูุณุน)
๐ง Settings ุงูุฃุณุงุณูุฉ
ูู app/core/settings.py:
from typing import Literal
from pydantic import BaseSettings

class Settings(BaseSettings):
    # -------------------------------------------------
    # OPERATION MODE (TIER SWITCH)
    # -------------------------------------------------
    OPERATION_TIER: Literal[
        "tier0_fortress",
        "tier1_governed",
        "tier2_vanna"
    ] = "tier1_governed"

    # -------------------------------------------------
    # VANNA (Tier 2 only)


